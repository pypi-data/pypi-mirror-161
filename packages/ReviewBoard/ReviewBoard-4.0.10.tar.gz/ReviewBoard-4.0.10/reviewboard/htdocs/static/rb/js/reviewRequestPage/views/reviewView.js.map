{"version":3,"sources":["reviewView.es6.js"],"names":[],"mappings":"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","file":"reviewView.js","sourcesContent":["/**\n * Handles interaction for a review on the review request page. These can be\n * contained within the main review entries, but also for status updates in\n * change description entries or the initial status updates entry.\n */\nRB.ReviewRequestPage.ReviewView = Backbone.View.extend({\n    /**\n     * Initialize the view.\n     */\n    initialize(options) {\n        this.options = options;\n        this.entryModel = options.entryModel;\n\n        this._bannerView = null;\n        this._draftBannerShown = false;\n        this._openIssueCount = 0;\n        this._reviewReply = null;\n        this._replyEditors = [];\n        this._replyEditorViews = [];\n        this._replyDraftsCount = 0;\n        this._diffFragmentViews = [];\n\n        this._$reviewComments = null;\n        this._$bodyTop = null;\n        this._$bodyBottom = null;\n\n        this.model.set('includeTextTypes', 'html,raw,markdown');\n\n        this._setupNewReply();\n\n        this.listenTo(this.entryModel, 'change:collapsed', () => {\n            if (!this.entryModel.get('collapsed')) {\n                this._diffFragmentViews.forEach(\n                    view => view.hideControls(false));\n            }\n        });\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.ReviewRequestPage.ReviewView:\n     *     This object, for chaining.\n     */\n    render() {\n        const reviewRequestEditor = this.entryModel.get('reviewRequestEditor');\n\n        this._$reviewComments = this.$('.review-comments');\n\n        const $comment = this._$reviewComments.find(\n            '.review-comment-details .review-comment');\n        this._$bodyTop = $comment.find('.body_top');\n        this._$bodyBottom = $comment.find('.body_bottom');\n\n        this._replyDraftsCount = 0;\n\n        this.on('hasDraftChanged', hasDraft => {\n            if (hasDraft) {\n                this._showReplyDraftBanner();\n            } else {\n                this._hideReplyDraftBanner();\n            }\n        });\n\n        _.each(this._$reviewComments.find('.issue-indicator'), el => {\n            const $issueState = $('.issue-state', el);\n\n            /*\n             * Not all issue-indicator divs have an issue-state div for the\n             * issue bar.\n             */\n            if ($issueState.length > 0) {\n                const issueStatus = $issueState.data('issue-status');\n\n                if (RB.BaseComment.isStateOpen(issueStatus)) {\n                    this._openIssueCount++;\n                }\n\n                const issueBar = new RB.CommentIssueBarView({\n                    el: el,\n                    reviewID: this.model.id,\n                    canVerify: $issueState.data('can-verify'),\n                    commentID: $issueState.data('comment-id'),\n                    commentType: $issueState.data('comment-type'),\n                    interactive: $issueState.data('interactive'),\n                    issueStatus: issueStatus,\n                });\n\n                issueBar.render();\n\n                this.listenTo(issueBar, 'statusChanged',\n                              (oldStatus, newStatus) => {\n                    const oldOpen = RB.BaseComment.isStateOpen(oldStatus);\n                    const newOpen = RB.BaseComment.isStateOpen(newStatus);\n\n                    if (oldOpen !== newOpen) {\n                        if (newOpen) {\n                            this._openIssueCount++;\n                        } else {\n                            this._openIssueCount--;\n                        }\n                    }\n\n                    this.trigger('openIssuesChanged');\n                });\n            }\n        });\n\n        _.each(this.$('.comment-section'), el => {\n            const $el = $(el);\n            const editor = new RB.ReviewRequestPage.ReviewReplyEditor({\n                anchorPrefix: $el.data('reply-anchor-prefix'),\n                contextID: $el.data('context-id'),\n                contextType: $el.data('context-type'),\n                review: this.model,\n                reviewReply: this._reviewReply,\n            });\n\n            const view = new RB.ReviewRequestPage.ReviewReplyEditorView({\n                el: el,\n                model: editor,\n                reviewRequestEditor: reviewRequestEditor,\n            });\n            view.render();\n\n            this.listenTo(editor, 'change:hasDraft', (model, hasDraft) => {\n                if (hasDraft) {\n                    this._replyDraftsCount++;\n                    this.trigger('hasDraftChanged', true);\n                } else {\n                    this._replyDraftsCount--;\n\n                    if (this._replyDraftsCount === 0) {\n                        this.trigger('hasDraftChanged', false);\n                    }\n                }\n            });\n\n            this._replyEditors.push(editor);\n            this._replyEditorViews.push(view);\n\n            if (editor.get('hasDraft')) {\n                this._replyDraftsCount++;\n            }\n        });\n\n        if (this._replyDraftsCount > 0) {\n            this.trigger('hasDraftChanged', true);\n        }\n\n        /*\n         * Load any diff fragments for comments made on this review. Each\n         * will be queued up and loaded when the page is rendered.\n         */\n        this._diffFragmentViews = [];\n\n        const page = RB.PageManager.getPage();\n        const diffCommentsData = this.entryModel.get('diffCommentsData');\n\n        for (let i = 0; i < diffCommentsData.length; i++) {\n            const diffCommentData = diffCommentsData[i];\n\n            page.queueLoadDiff(diffCommentData[0], diffCommentData[1],\n                               view => this._diffFragmentViews.push(view));\n        }\n\n        /*\n         * Do this last, after ReviewReplyEditorView has already set up the\n         * inline editors.\n         */\n        const reviewRequest = this.model.get('parentObject');\n        const bugTrackerURL = reviewRequest.get('bugTrackerURL');\n        _.each(this.$('pre.reviewtext'), el => {\n            RB.formatText($(el), { bugTrackerURL: bugTrackerURL });\n        });\n\n        this.listenTo(this.model, 'change:bodyTop',\n                      this._onBodyTopChanged);\n        this.listenTo(this.model, 'change:bodyBottom',\n                      this._onBodyBottomChanged);\n        this.listenTo(this.model, 'change:bodyTopRichText',\n                      this._onBodyTopRichTextChanged);\n        this.listenTo(this.model, 'change:bodyBottomRichText',\n                      this._onBodyBottomRichTextChanged);\n\n        return this;\n    },\n\n    /**\n     * Handler for when the Body Top field of a review changes.\n     *\n     * Updates the HTML for the field to show the new content.\n     */\n    _onBodyTopChanged() {\n        this._$bodyTop.html(this.model.get('htmlTextFields').bodyTop);\n    },\n\n    /**\n     * Handler for when the Body Top's Rich Text field of a review changes.\n     *\n     * Updates the class on the field to reflect the Rich Text state.\n     */\n    _onBodyTopRichTextChanged() {\n        if (this.model.get('bodyTopRichText')) {\n            this._$bodyTop.addClass('rich-text');\n        } else {\n            this._$bodyTop.removeClass('rich-text');\n        }\n    },\n\n    /**\n     * Handler for when the Body Bottom field of a review changes.\n     *\n     * Updates the HTML for the field to show the new content. The visibility\n     * of the body section will also be dependent on whether there is any\n     * content (mimicking the logic used when rendering the page).\n     */\n    _onBodyBottomChanged() {\n        const html = this.model.get('htmlTextFields').bodyBottom;\n\n        this._$bodyBottom\n            .html(html)\n            .closest('li').setVisible(html && html.length > 0);\n    },\n\n    /**\n     * Handler for when the Body Bottom's Rich Text field of a review changes.\n     *\n     * Updates the class on the field to reflect the Rich Text state.\n     */\n    _onBodyBottomRichTextChanged() {\n        if (this.model.get('bodyBottomRichText')) {\n            this._$bodyBottom.addClass('rich-text');\n        } else {\n            this._$bodyBottom.removeClass('rich-text');\n        }\n    },\n\n    /**\n     * Return whether there are any open issues in the review.\n     *\n     * Returns:\n     *     boolean:\n     *     true if there are any open issues.\n     */\n    hasOpenIssues() {\n        return this._openIssueCount > 0;\n    },\n\n    /**\n     * Return the number of open issues in the review.\n     *\n     * Returns:\n     *     number:\n     *     The number of open issues.\n     */\n    getOpenIssueCount() {\n        return this._openIssueCount;\n    },\n\n    /**\n     * Return the ReviewReplyEditorView with the given context type and ID.\n     *\n     * Args:\n     *     contextType (string):\n     *         The type of object being replied to (such as ``body_top`` or\n     *         ``diff_comments``)\n     *\n     *     contextID (number, optional):\n     *         The ID of the comment being replied to, if appropriate.\n     *\n     * Returns:\n     *     RB.ReviewRequestPage.ReviewReplyEditorView:\n     *     The matching editor view.\n     */\n    getReviewReplyEditorView(contextType, contextID) {\n        if (contextID === undefined) {\n            contextID = null;\n        }\n\n        return _.find(this._replyEditorViews, view => {\n            const editor = view.model;\n            return editor.get('contextID') === contextID &&\n                   editor.get('contextType') === contextType;\n        });\n    },\n\n    /**\n     * Return the active reply.\n     *\n     * Returns:\n     *     RB.ReviewReply:\n     *     The active draft reply, or null if none exists.\n     */\n    getReviewReply() {\n        return this._reviewReply;\n    },\n\n    /**\n     * Set up a new ReviewReply for the editors.\n     *\n     * The new ReviewReply will be used for any new comments made on this\n     * review.\n     *\n     * A ReviewReply is set until it's either destroyed or published, at\n     * which point a new one is set.\n     *\n     * Args:\n     *     reviewReply (RB.ReviewReply, optional):\n     *         The reply object. If this is ``null``, a new ``RB.ReviewReply``\n     *         will be created. Note that this argument is only expected to be\n     *         used for unit testing.\n     */\n    _setupNewReply(reviewReply) {\n        if (!reviewReply) {\n            reviewReply = this.model.createReply();\n        }\n\n        if (this._reviewReply !== null) {\n            this.stopListening(this._reviewReply);\n\n            // Update all the existing editors to point to the new object.\n            this._replyEditors.forEach(\n                editor => editor.set('reviewReply', reviewReply));\n\n            this.trigger('hasDraftChanged', false);\n        }\n\n        this.listenTo(reviewReply, 'destroyed published',\n                      () => this._setupNewReply());\n\n        this._reviewReply = reviewReply;\n    },\n\n    /**\n     * Show the reply draft banner.\n     *\n     * This will be called in response to any new replies made on a review,\n     * or if there are pending replies that already exist on the review.\n     */\n    _showReplyDraftBanner() {\n        if (!this._draftBannerShown) {\n            this._bannerView =\n                new RB.ReviewRequestPage.ReviewReplyDraftBannerView({\n                    model: this._reviewReply,\n                    $floatContainer: this.options.$bannerFloatContainer,\n                    noFloatContainerClass:\n                        this.options.bannerNoFloatContainerClass,\n                    reviewRequestEditor: this.entryModel.get(\n                        'reviewRequestEditor'),\n                });\n\n            this._bannerView.render();\n            this._bannerView.$el.appendTo(this.options.$bannerParent);\n            this._draftBannerShown = true;\n        }\n    },\n\n    /**\n     * Hide the reply draft banner.\n     */\n    _hideReplyDraftBanner() {\n        if (this._draftBannerShown) {\n            this._bannerView.remove();\n            this._bannerView = null;\n            this._draftBannerShown = false;\n        }\n    },\n});\n"]}
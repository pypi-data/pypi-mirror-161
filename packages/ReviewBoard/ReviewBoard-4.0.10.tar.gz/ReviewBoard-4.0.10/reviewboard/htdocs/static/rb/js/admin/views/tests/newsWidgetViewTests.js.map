{"version":3,"sources":["newsWidgetViewTests.es6.js"],"names":[],"mappings":"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","file":"newsWidgetViewTests.js","sourcesContent":["suite('rb/admin/views/NewsWidgetView', function() {\n    const template = dedent`\n        <div class=\"rb-c-admin-widget rb-c-news-admin-widget\">\n         <header class=\"rb-c-admin-widget__header\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </header>\n         <div class=\"rb-c-admin-widget__content\"></div>\n         <footer class=\"rb-c-admin-widget__footer\">\n          <ul class=\"rb-c-admin-widget__actions\"></ul>\n         </footer>\n        </div>\n    `;\n\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.Admin.NewsWidget({\n            newsURL: 'http://example.com/news/',\n        });\n\n        view = new RB.Admin.NewsWidgetView({\n            el: $(template),\n            model: model,\n        });\n\n        spyOn(model, 'loadNews');\n    });\n\n    describe('Rendering', function() {\n        describe('Actions', function() {\n            it('More News', function() {\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(1);\n\n                const $action = $actions.eq(0);\n                expect($action.hasClass('js-action-more-news')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/');\n            });\n\n            it('Subscribe', function() {\n                model.set('subscribeURL', 'http://example.com/news/subscribe/');\n                view.render();\n\n                const $actions = view.$footerActions.children();\n                expect($actions.length).toBe(2);\n\n                const $action = $actions.eq(1);\n                expect($action.hasClass('js-action-subscribe')).toBeTrue();\n                expect($action.children('a').attr('href'))\n                    .toBe('http://example.com/news/subscribe/');\n            });\n\n            describe('Reload', function() {\n                it('On loadingNews event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n\n                    model.trigger('loadingNews');\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n                });\n\n                it('On change:newsItems event', function() {\n                    view.render();\n\n                    const $action = view.$headerActions.children(\n                        '.js-action-reload');\n\n                    view.setReloading(true);\n                    expect($action.hasClass('fa-spin')).toBeTrue();\n\n                    model.set('newsItems', []);\n                    expect($action.hasClass('fa-spin')).toBeFalse();\n                });\n            });\n        });\n\n        it('News items', function() {\n            view.render();\n\n            model.set('newsItems', [\n                {\n                    date: moment(Date.UTC(2019, 9, 21, 0, 26, 32)),\n                    title: 'Headline 6',\n                    url: 'http://example.com/news/post6',\n                },\n                {\n                    date: moment(Date.UTC(2019, 9, 1, 20, 29, 0)),\n                    title: 'Headline 5',\n                    url: 'http://example.com/news/post5',\n                },\n                {\n                    date: moment(Date.UTC(2019, 8, 27, 2, 29, 33)),\n                    title: 'Headline 4',\n                    url: 'http://example.com/news/post4',\n                },\n            ]);\n\n            const $items = view.$content.children();\n            expect($items.length).toBe(3);\n\n            let $item = $items.eq(0);\n            expect($item.attr('href')).toBe('http://example.com/news/post6');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date').text().strip()\n            ).toBe('Oct 20');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title').text().strip()\n            ).toBe('Headline 6');\n\n            $item = $items.eq(1);\n            expect($item.attr('href')).toBe('http://example.com/news/post5');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().strip()\n            ).toBe('Oct 01');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().strip()\n            ).toBe('Headline 5');\n\n            $item = $items.eq(2);\n            expect($item.attr('href')).toBe('http://example.com/news/post4');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-date')\n                .text().strip()\n            ).toBe('Sep 26');\n            expect(\n                $item.find('.rb-c-admin-news-widget__item-title')\n                .text().strip()\n            ).toBe('Headline 4');\n        });\n\n        it('Load errors', function() {\n            view.render();\n\n            model.set('newsItems', []);\n\n            const $els = view.$content.children();\n            expect($els.length).toBe(1);\n\n            const $error = $els.eq(0);\n            expect($error.hasClass('rb-c-admin-news-widget__error'))\n                .toBeTrue();\n            expect($error.html().strip()).toBe(\n                'There was an error loading the news. Please ' +\n                '<a href=\"http://example.com/news/\">visit the news page</a> ' +\n                'directly, or try again later.');\n        });\n    });\n});\n"]}
{"version":3,"sources":["formViewTests.es6.js"],"names":[],"mappings":"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","file":"formViewTests.js","sourcesContent":["suite('rb/ui/views/FormView', function() {\n    const template = dedent`\n        <form class=\"rb-c-form\">\n         <select id=\"subform1-selector\"\n                 data-subform-group=\"group1\">\n          <option value=\"subform1\">subform1</option>\n          <option value=\"subform2\">subform2</option>\n         </select>\n\n         <fieldset class=\"rb-c-form-fieldset\">\n          <legend class=\"rb-c-form-fieldset__name\">\n           Title\n           <a href=\"#\" class=\"rb-c-form-fieldset__toggle\">(Hide)</a>\n          </legend>\n          <div class=\"rb-c-form-fieldset__content\"></div>\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-collapsed\">\n          <legend class=\"rb-c-form-fieldset__name\">\n           Title\n           <a href=\"#\" class=\"rb-c-form-fieldset__toggle\">(Show)</a>\n          </legend>\n          <div class=\"rb-c-form-fieldset__content\"></div>\n         </fieldset>\n\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-controller=\"subform1-selector\"\n                   data-subform-id=\"subform1\">\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-controller=\"subform1-selector\"\n                   data-subform-id=\"subform2\">\n         </fieldset>\n\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-group=\"group2\"\n                   data-subform-id=\"subform3\">\n         </fieldset>\n         <fieldset class=\"rb-c-form-fieldset -is-subform\"\n                   data-subform-group=\"group2\"\n                   data-subform-id=\"subform4\"\n                   disabled hidden>\n         </fieldset>\n        </form>\n    `;\n\n    let view;\n    let $subforms;\n\n    beforeEach(function() {\n        view = new RB.FormView({\n            el: $(template),\n        });\n        view.render().$el.appendTo($testsScratch);\n\n        $subforms = view._$subforms;\n    });\n\n    function checkSubformVisibility(index, visible) {\n        const $subform = $subforms.eq(index);\n\n        expect($subform.prop('disabled')).toBe(!visible);\n        expect($subform.prop('hidden')).toBe(!visible);\n    }\n\n    describe('Fieldsets', function() {\n        it('Collapsing', function() {\n            const $fieldset = view.$('.rb-c-form-fieldset').eq(0);\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(false);\n\n            $fieldset.find('.rb-c-form-fieldset__toggle').click();\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(true);\n            expect($fieldset.find('.rb-c-form-fieldset__toggle').text())\n                .toBe('(Show)');\n        });\n\n        it('Expanding', function() {\n            const $fieldset = view.$('.rb-c-form-fieldset').eq(1);\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(true);\n\n            $fieldset.find('.rb-c-form-fieldset__toggle').click();\n\n            expect($fieldset.hasClass('-is-collapsed')).toBe(false);\n            expect($fieldset.find('.rb-c-form-fieldset__toggle').text())\n                .toBe('(Hide)');\n        });\n    });\n\n    describe('Subforms', function() {\n        it('Loaded state', function() {\n            expect($subforms.length).toBe(4);\n            expect(_.keys(view._subformsByGroup))\n                .toEqual(['group1', 'group2']);\n            expect(_.keys(view._subformsByGroup.group1))\n                .toEqual(['subform1', 'subform2']);\n            expect(_.keys(view._subformsByGroup.group2))\n                .toEqual(['subform3', 'subform4']);\n            expect(view._subformsByGroup.group1.subform1[0])\n                .toBe($subforms[0]);\n            expect(view._subformsByGroup.group1.subform2[0])\n                .toBe($subforms[1]);\n            expect(view._subformsByGroup.group2.subform3[0])\n                .toBe($subforms[2]);\n            expect(view._subformsByGroup.group2.subform4[0])\n                .toBe($subforms[3]);\n\n            checkSubformVisibility(0, true);\n            checkSubformVisibility(1, false);\n            checkSubformVisibility(2, true);\n            checkSubformVisibility(3, false);\n        });\n\n        it('Controller value changed', function() {\n            view.$el.children('select')\n                .val('subform2')\n                .triggerHandler('change');\n\n            checkSubformVisibility(0, false);\n            checkSubformVisibility(1, true);\n            checkSubformVisibility(2, true);\n            checkSubformVisibility(3, false);\n        });\n    });\n\n    describe('Methods', function() {\n        describe('setSubformVisibility', function() {\n            it('With group', function() {\n                view.setSubformVisibility({\n                    group: 'group2',\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n            });\n\n            it('With group, visible', function() {\n                view.setSubformVisibility({\n                    group: 'group2',\n                    visible: true,\n                });\n\n                checkSubformVisibility(2, true);\n                checkSubformVisibility(3, true);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    visible: false,\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n            });\n\n            it('With group, subformID, visible', function() {\n                checkSubformVisibility(2, true);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    subformID: 'subform3',\n                    visible: false,\n                });\n\n                checkSubformVisibility(2, false);\n                checkSubformVisibility(3, false);\n\n                view.setSubformVisibility({\n                    group: 'group2',\n                    subformID: 'subform4',\n                    visible: true,\n                });\n\n                checkSubformVisibility(3, true);\n            });\n\n            it('With group, subformID, visible, hideOthers', function() {\n                view.setSubformVisibility({\n                    group: 'group1',\n                    subformID: 'subform2',\n                    visible: true,\n                    hideOthers: true,\n                });\n\n                checkSubformVisibility(0, false);\n                checkSubformVisibility(1, true);\n\n                view.setSubformVisibility({\n                    group: 'group1',\n                    subformID: 'subform1',\n                    visible: true,\n                    hideOthers: true,\n                });\n\n                checkSubformVisibility(0, true);\n                checkSubformVisibility(1, false);\n            });\n        });\n    });\n});\n"]}
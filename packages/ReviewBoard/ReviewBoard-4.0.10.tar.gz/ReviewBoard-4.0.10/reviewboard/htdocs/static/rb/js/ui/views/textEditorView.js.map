{"version":3,"sources":["textEditorView.es6.js"],"names":[],"mappings":"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","file":"textEditorView.js","sourcesContent":["(function() {\n\n\n/*\n * Define a CodeMirror mode we can plug in as the default below.\n *\n * This mode won't have any special highlighting, but will avoid the Markdown\n * mode's default behavior of rendering \"plain/text\" code (the default) the\n * same way as literal code, which we really want to avoid.\n */\nCodeMirror.defineSimpleMode('rb-text-plain', {\n    start: [\n        {\n            regex: /.*/,\n            token: 'rb-cm-codeblock-plain',\n            next: 'start',\n        },\n    ],\n});\n\nCodeMirror.defineMIME('text/plain', 'rb-text-plain');\n\n\n/**\n * Wraps CodeMirror, providing a standard interface for TextEditorView's usage.\n */\nconst CodeMirrorWrapper = Backbone.View.extend({\n    /**\n     * Initialize CodeMirrorWrapper.\n     *\n     * This will set up CodeMirror based on the objects, add it to the parent,\n     * and begin listening to events.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the wrapper.\n     *\n     * Option Args:\n     *     autoSize (boolean):\n     *         Whether the editor should automatically resize itself to fit its\n     *         container.\n     *\n     *     parentEl (Element):\n     *        The parent element for the editor.\n     *\n     *    minHeight (number):\n     *        The minimum vertical size of the editor.\n     */\n    initialize(options) {\n        this.options = options;\n\n        const codeMirrorOptions = {\n            mode: {\n                highlightFormatting: true,\n                name: 'gfm',\n\n                /*\n                 * The following token type overrides will be prefixed with\n                 * ``cm-`` when used as classes.\n                 */\n                tokenTypeOverrides: {\n                    code: 'rb-markdown-code',\n                    list1: 'rb-markdown-list1',\n                    list2: 'rb-markdown-list2',\n                    list3: 'rb-markdown-list3'\n                }\n            },\n            theme: 'rb default',\n            lineWrapping: true,\n            electricChars: false,\n            styleSelectedText: true,\n            extraKeys: {\n                'Home': 'goLineLeft',\n                'End': 'goLineRight',\n                'Enter': 'newlineAndIndentContinueMarkdownList',\n                'Shift-Tab': false,\n                'Tab': false\n            }\n        };\n\n        if (options.autoSize) {\n            codeMirrorOptions.viewportMargin = Infinity;\n        }\n\n        this._codeMirror = new CodeMirror(options.parentEl,\n                                          codeMirrorOptions);\n\n        this.setElement(this._codeMirror.getWrapperElement());\n\n        if (this.options.minHeight !== undefined) {\n            this.$el.css('min-height', this.options.minHeight);\n        }\n\n        this._codeMirror.on('viewportChange',\n                            () => this.$el.triggerHandler('resize'));\n        this._codeMirror.on('change', () => this.trigger('change'));\n    },\n\n    /**\n     * Return whether or not the editor's contents have changed.\n     *\n     * Args:\n     *     initialValue (string):\n     *         The initial value of the editor.\n     *\n     * Returns:\n     *     boolean:\n     *     Whether or not the editor is dirty.\n     */\n    isDirty(initialValue) {\n        /*\n         * We cannot trust codeMirror's isClean() method.\n         *\n         * It is also possible for initialValue to be undefined, so we use an\n         * empty string in that case instead.\n         */\n        return (initialValue || '') !== this.getText();\n    },\n\n    /**\n     * Set the text in the editor.\n     *\n     * Args:\n     *     text (string):\n     *         The new text for the editor.\n     */\n    setText(text) {\n        this._codeMirror.setValue(text);\n    },\n\n    /**\n     * Return the text in the editor.\n     *\n     * Returns:\n     *     string:\n     *     The current contents of the editor.\n     */\n    getText() {\n        return this._codeMirror.getValue();\n    },\n\n    /**\n     * Insert a new line of text into the editor.\n     *\n     * If the editor has focus, insert at the cursor position. Otherwise,\n     * insert at the end.\n     *\n     * Args:\n     *     text (string):\n     *         The text to insert.\n     */\n    insertLine(text) {\n        let position;\n\n        if (this._codeMirror.hasFocus()) {\n            const cursor = this._codeMirror.getCursor();\n            const line = this._codeMirror.getLine(cursor.line);\n            position = CodeMirror.Pos(cursor.line, line.length - 1);\n\n            if (line.length !== 0) {\n                /*\n                 * If the current line has some content, insert the new text on\n                 * the line after it.\n                 */\n                text = '\\n' + text;\n            }\n\n            if (!text.endsWith('\\n')) {\n                text += '\\n';\n            }\n        } else {\n            position = CodeMirror.Pos(this._codeMirror.lastLine());\n            text = '\\n' + text;\n        }\n\n        this._codeMirror.replaceRange(text, position);\n    },\n\n    /**\n     * Return the full client height of the content.\n     *\n     * Returns:\n     *     number:\n     *     The client height of the editor.\n     */\n    getClientHeight() {\n        return this._codeMirror.getScrollInfo().clientHeight;\n    },\n\n    /**\n     * Set the size of the editor.\n     *\n     * Args:\n     *     width (number):\n     *         The new width of the editor.\n     *\n     *     height (number):\n     *         The new height of the editor.\n     */\n    setSize(width, height) {\n        this._codeMirror.setSize(width, height);\n        this._codeMirror.refresh();\n    },\n\n    /**\n     * Focus the editor.\n     */\n    focus() {\n        this._codeMirror.focus();\n    }\n});\n\n\n/**\n * Wraps <textarea>, providing a standard interface for TextEditorView's usage.\n */\nconst TextAreaWrapper = Backbone.View.extend({\n    tagName: 'textarea',\n\n    /*\n     * Initialize TextAreaWrapper.\n     *\n     * This will set up the element based on the provided options, begin\n     * listening for events, and add the element to the parent.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the wrapper.\n     *\n     * Option Args:\n     *     autoSize (boolean):\n     *         Whether the editor should automatically resize itself to fit its\n     *         container.\n     *\n     *     parentEl (Element):\n     *        The parent element for the editor.\n     *\n     *    minHeight (number):\n     *        The minimum vertical size of the editor.\n     */\n    initialize(options) {\n        this.options = options;\n\n        if (options.autoSize) {\n            this.$el.autoSizeTextArea();\n        }\n\n        this.$el\n            .css('width', '100%')\n            .appendTo(options.parentEl)\n            .on('change keydown keyup keypress', () => this.trigger('change'));\n\n        if (options.minHeight !== undefined) {\n            if (options.autoSize) {\n                this.$el.autoSizeTextArea('setMinHeight',\n                                          options.minHeight);\n            } else {\n                this.$el.css('min-height', this.options.minHeight);\n            }\n        }\n    },\n\n    /**\n     * Return whether or not the editor's contents have changed.\n     *\n     * Args:\n     *     initialValue (string):\n     *         The initial value of the editor.\n     *\n     * Returns:\n     *     boolean:\n     *     Whether or not the editor is dirty.\n     */\n    isDirty(initialValue) {\n        const value = this.el.value || '';\n\n        return value.length !== initialValue.length ||\n               value !== initialValue;\n    },\n\n    /**\n     * Set the text in the editor.\n     *\n     * Args:\n     *     text (string):\n     *         The new text for the editor.\n     */\n    setText(text) {\n        this.el.value = text;\n\n        if (this.options.autoSize) {\n            this.$el.autoSizeTextArea('autoSize');\n        }\n    },\n\n    /**\n     * Return the text in the editor.\n     *\n     * Returns:\n     *     string:\n     *     The current contents of the editor.\n     */\n    getText() {\n        return this.el.value;\n    },\n\n    /**\n     * Insert a new line of text into the editor.\n     *\n     * Args:\n     *     text (string):\n     *         The text to insert.\n     */\n    insertLine(text) {\n        if (this.$el.is(':focus')) {\n            const value = this.el.value;\n            const cursor = this.el.selectionEnd;\n            const endOfLine = value.indexOf('\\n', cursor);\n\n            if (endOfLine === -1) {\n                // The cursor is on the last line.\n                this.el.value += '\\n' + text;\n            } else {\n                // The cursor is in the middle of the text.\n                this.el.value = (value.slice(0, endOfLine + 1) + '\\n' + text +\n                                 '\\n' + value.slice(endOfLine));\n            }\n        } else {\n            this.el.value += '\\n' + text;\n        }\n    },\n\n    /**\n     * Return the full client height of the content.\n     *\n     * Returns:\n     *     number:\n     *     The client height of the editor.\n     */\n    getClientHeight() {\n        return this.el.clientHeight;\n    },\n\n    /**\n     * Set the size of the editor.\n     *\n     * Args:\n     *     width (number):\n     *         The new width of the editor.\n     *\n     *     height (number):\n     *         The new height of the editor.\n     */\n    setSize(width, height) {\n        if (width !== null) {\n            this.$el.innerWidth(width);\n        }\n\n        if (height !== null) {\n            if (height === 'auto' && this.options.autoSize) {\n                this.$el.autoSizeTextArea('autoSize', true);\n            } else {\n                this.$el.innerHeight(height);\n            }\n        }\n    },\n\n    /**\n     * Focus the editor.\n     */\n    focus() {\n        this.$el.focus();\n    }\n});\n\n\n/**\n * Provides an editor for editing plain or Markdown text.\n *\n * The editor allows for switching between plain or Markdown text on-the-fly.\n *\n * When editing plain text, this uses a standard textarea widget.\n *\n * When editing Markdown, this makes use of CodeMirror. All Markdown content\n * will be formatted as the user types, making it easier to notice when a\n * stray _ or ` will cause Markdown-specific behavior.\n */\nRB.TextEditorView = Backbone.View.extend({\n    className: 'text-editor',\n\n    defaultOptions: {\n        autoSize: true,\n        minHeight: 70\n    },\n\n    events: {\n        'focus': 'focus',\n        'remove': '_onRemove'\n    },\n\n    /**\n     * Initialize the view with any provided options.\n     *\n     * Args:\n     *     options (object):\n     *         Options for view construction.\n     *\n     * Option Args:\n     *     richText (boolean):\n     *         Whether the editor is using rich text (Markdown).\n     *\n     *     text (string):\n     *         The initial text.\n     *\n     *     bindRichText (object):\n     *         An object with ``model`` and ``attrName`` keys, for when the\n     *         rich text should be bound to an attribute on another model.\n     */\n    initialize(options={}) {\n        this._files = [];\n        this._editor = null;\n        this._prevClientHeight = null;\n\n        this.options = _.defaults(options, this.defaultOptions);\n        this.richText = !!this.options.richText;\n        this._dropTarget = null;\n        this._value = this.options.text || '';\n        this._richTextDirty = false;\n\n        if (this.options.bindRichText) {\n            this.bindRichTextAttr(this.options.bindRichText.model,\n                                  this.options.bindRichText.attrName);\n        }\n\n        /*\n         * If the user is defaulting to rich text, we're going to want to\n         * show the rich text UI by default, even if any bound rich text\n         * flag is set to False.\n         *\n         * This requires cooperation with the template or API results\n         * that end up backing this TextEditor. The expectation is that\n         * those will be providing escaped data for any plain text, if\n         * the user's set to use rich text by default. If this expectation\n         * holds, the user will have a consistent experience for any new\n         * text fields.\n         */\n        if (RB.UserSession.instance.get('defaultUseRichText')) {\n            this.setRichText(true);\n        }\n    },\n\n    /**\n     * Render the text editor.\n     *\n     * This will set the class name on the element, ensuring we have a\n     * standard set of styles, even if this editor is bound to an existing\n     * element.\n     *\n     * Returns:\n     *     RB.TextEditorView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el.addClass(this.className);\n\n        return this;\n    },\n\n    /**\n     * Set whether or not rich text (Markdown) is to be used.\n     *\n     * This can dynamically change the text editor to work in plain text\n     * or Markdown.\n     *\n     * Args:\n     *     richText (boolean):\n     *         Whether the editor should use rich text.\n     */\n    setRichText(richText) {\n        if (richText === this.richText) {\n            return;\n        }\n\n        if (this._editor) {\n            this._hideEditor();\n            this.richText = richText;\n            this._showEditor();\n\n            this._richTextDirty = true;\n\n            this.$el.triggerHandler('resize');\n        } else {\n            this.richText = richText;\n        }\n\n        this.trigger('change:richText', richText);\n        this.trigger('change');\n    },\n\n    /**\n     * Bind a richText attribute on a model to the mode on this editor.\n     *\n     * This editor's richText setting will stay in sync with the attribute\n     * on the given mode.\n     *\n     * Args:\n     *     model (Backbone.Model):\n     *         A model to bind to.\n     *\n     *     attrName (string):\n     *         The name of the attribute to bind.\n     */\n    bindRichTextAttr(model, attrName) {\n        this.setRichText(model.get(attrName));\n\n        this.listenTo(model, `change:${attrName}`,\n                      (model, value) => this.setRichText(value));\n    },\n\n    /**\n     * Bind an Enable Markdown checkbox to this text editor.\n     *\n     * The checkbox will initially be set to the value of the editor's\n     * richText property. Toggling the checkbox will then manipulate that\n     * property.\n     *\n     * Args:\n     *     $checkbox (jQuery):\n     *         The checkbox to bind.\n     */\n    bindRichTextCheckbox($checkbox) {\n        $checkbox\n            .prop('checked', this.richText)\n            .on('change', () => this.setRichText($checkbox.prop('checked')));\n\n        this.on('change:richText',\n                () => $checkbox.prop('checked', this.richText));\n    },\n\n    /**\n     * Bind the visibility of an element to the richText property.\n     *\n     * If richText ist true, the element will be shown. Otherwise, it\n     * will be hidden.\n     *\n     * Args:\n     *     $el (jQuery):\n     *         The element to show when richText is true.\n     */\n    bindRichTextVisibility($el) {\n        $el.setVisible(this.richText);\n\n        this.on('change:richText', () => $el.setVisible(this.richText));\n    },\n\n    /**\n     * Return whether or not the editor's contents have changed.\n     *\n     * Args:\n     *     initialValue (string):\n     *         The initial value of the editor.\n     *\n     * Returns:\n     *     boolean:\n     *     Whether or not the editor is dirty.\n     */\n    isDirty(initialValue) {\n        return this._editor !== null &&\n               (this._richTextDirty ||\n                this._editor.isDirty(initialValue || ''));\n    },\n\n    /**\n     * Set the text in the editor.\n     *\n     * Args:\n     *     text (string):\n     *         The new text for the editor.\n     */\n    setText(text) {\n        if (text !== this.getText()) {\n            if (this._editor) {\n                this._editor.setText(text);\n            } else {\n                this._value = text;\n            }\n        }\n    },\n\n    /**\n     * Return the text in the editor.\n     *\n     * Returns:\n     *     string:\n     *     The current contents of the editor.\n     */\n    getText() {\n        return this._editor ? this._editor.getText() : this._value;\n    },\n\n    /**\n     * Insert a new line of text into the editor.\n     *\n     * Args:\n     *     text (string):\n     *         The text to insert.\n     */\n    insertLine(text) {\n        if (this._editor) {\n            this._editor.insertLine(text);\n        } else {\n            if (this._value.endsWith('\\n')) {\n                this._value += text + '\\n';\n            } else {\n                this._value += '\\n' + text;\n            }\n        }\n    },\n\n    /**\n     * Set the size of the editor.\n     *\n     * Args:\n     *     width (number):\n     *         The new width of the editor.\n     *\n     *     height (number):\n     *         The new height of the editor.\n     */\n    setSize(width, height) {\n        if (this._editor) {\n            this._editor.setSize(width, height);\n        }\n    },\n\n    /**\n     * Show the editor.\n     */\n    show() {\n        this.$el.show();\n        this._showEditor();\n    },\n\n    /**\n     * Hide the editor.\n     */\n    hide() {\n        this._hideEditor();\n        this.$el.hide();\n    },\n\n    /**\n     * Focus the editor.\n     */\n    focus() {\n        if (this._editor) {\n            this._editor.focus();\n        }\n    },\n\n    /**\n     * Handler for the remove event.\n     *\n     * Disables the drag-and-drop overlay.\n     */\n    _onRemove() {\n        RB.DnDUploader.instance.unregisterDropTarget(this.$el);\n    },\n\n    /**\n     * Show the actual editor wrapper.\n     *\n     * Any stored text will be transferred to the editor, and the editor\n     * will take control over all operations.\n     */\n    _showEditor() {\n        const EditorCls = this.richText ? CodeMirrorWrapper : TextAreaWrapper;\n\n        if (this.richText) {\n            RB.DnDUploader.instance.registerDropTarget(\n                this.$el, gettext('Drop to add an image'),\n                this._uploadImage.bind(this));\n        }\n\n        this._editor = new EditorCls({\n            parentEl: this.el,\n            autoSize: this.options.autoSize,\n            minHeight: this.options.minHeight\n        });\n\n        this._editor.setText(this._value);\n        this._value = '';\n        this._richTextDirty = false;\n        this._prevClientHeight = null;\n\n        this._editor.$el.on(\n            'resize',\n            _.throttle(() => this.$el.triggerHandler('resize'), 250));\n\n        this.listenTo(this._editor, 'change', _.throttle(() => {\n            /*\n             * Make sure that the editor wasn't closed before the throttled\n             * handler was reached.\n             */\n            if (this._editor === null) {\n                return;\n            }\n\n            const clientHeight = this._editor.getClientHeight();\n\n            if (clientHeight !== this._prevClientHeight) {\n                this._prevClientHeight = clientHeight;\n                this.$el.triggerHandler('resize');\n            }\n\n            this.trigger('change');\n        }, 500));\n\n        this.focus();\n    },\n\n    /**\n     * Hide the actual editor wrapper.\n     *\n     * The last value from the editor will be stored for later retrieval.\n     */\n    _hideEditor() {\n        RB.DnDUploader.instance.unregisterDropTarget(this.$el);\n\n        if (this._editor) {\n            this._value = this._editor.getText();\n            this._richTextDirty = false;\n            this._editor.remove();\n            this._editor = null;\n\n            this.$el.empty();\n        }\n    },\n\n    /**\n     * Return whether or not a given file is an image.\n     *\n     * Args:\n     *     file (File):\n     *         The file to check.\n     *\n     * Returns:\n     *     boolean:\n     *     True if the given file appears to be an image.\n     */\n    _isImage(file) {\n        if (file.type) {\n            return (file.type.split('/')[0] === 'image');\n        }\n\n        const filename = file.name.toLowerCase();\n        return ['.jpeg', '.jpg', '.png', '.gif', '.bmp', '.tiff', '.svg'].some(\n            extension => filename.endsWith(extension));\n    },\n\n    /**\n     * Upload the image and append an image link to the editor's contents.\n     *\n     * Creates an instance of UserFileAttachment and saves it without the file,\n     * then updates the model with the file. This allows the file to be\n     * uploaded asynchronously after we get the link that is generated when the\n     * UserFileAttachment is created.\n     *\n     * Args:\n     *     file (File):\n     *         The image file to upload.\n     */\n    _uploadImage(file) {\n        if (!this._isImage(file)) {\n            return;\n        }\n\n        const userFileAttachment = new RB.UserFileAttachment({\n            caption: file.name,\n        });\n\n        userFileAttachment.save({\n            success: () => {\n                this.insertLine(\n                    `![Image](${userFileAttachment.get('downloadURL')})`);\n\n                userFileAttachment.set('file', file);\n                userFileAttachment.save({\n                    error: (model, response) => alert(response.errorText)\n                });\n            },\n            error: (model, response) => alert(response.errorText)\n        });\n    }\n}, {\n    /**\n     * Return options used to display a TextEditorView in an inlineEditor.\n     *\n     * Args:\n     *     options (object):\n     *         Options to be passed on to the TextEditorView.\n     *\n     * Returns:\n     *     object:\n     *     An options object to be used with an inlineEditor. The resulting\n     *     inlineEditor will make use of the TextEditorView instead of its\n     *     default textarea.\n     */\n    getInlineEditorOptions(options) {\n        let textEditor;\n\n        return {\n            matchHeight: false,\n            multiline: true,\n\n            createMultilineField(editor) {\n                const $editor = editor.element;\n                let origRichText;\n\n                textEditor = new RB.TextEditorView(options);\n                textEditor.render();\n\n                $editor.one('beginEdit', function() {\n                    const $buttons = $editor.inlineEditor('buttons');\n                    const $span = $('<span class=\"enable-markdown\" />');\n\n                    const $checkbox = $('<input/>')\n                        .attr({\n                            id: _.uniqueId('markdown_check'),\n                            type: 'checkbox'\n                        })\n                        .appendTo($span);\n                    textEditor.bindRichTextCheckbox($checkbox);\n\n                    $span.append($('<label/>')\n                        .attr('for', $checkbox[0].id)\n                        .text(gettext('Enable Markdown')));\n\n                    $buttons.append($span);\n\n                    const $markdownRef = $('<a/>')\n                        .addClass('markdown-info')\n                        .attr({\n                            href: MANUAL_URL + 'users/markdown/',\n                            target: '_blank'\n                        })\n                        .text(gettext('Markdown Reference'))\n                        .setVisible(textEditor.richText)\n                        .appendTo($buttons);\n                    textEditor.bindRichTextVisibility($markdownRef);\n                });\n\n                $editor.on('beginEdit', function() {\n                    textEditor._showEditor();\n                    origRichText = textEditor.richText;\n                });\n\n                $editor.on('cancel', function() {\n                    textEditor._hideEditor();\n                    textEditor.setRichText(origRichText);\n                });\n\n                $editor.on('complete', function() {\n                    textEditor._hideEditor();\n                });\n\n                textEditor.$el.data('text-editor', textEditor);\n\n                return textEditor.$el;\n            },\n\n            setFieldValue(editor, value) {\n                textEditor.setText(value || '');\n            },\n\n            getFieldValue() {\n                return textEditor.getText();\n            },\n\n            isFieldDirty(editor, initialValue) {\n                return textEditor.isDirty(initialValue);\n            }\n        };\n    },\n\n    /**\n     * Return the TextEditorView for an inlineEditor element.\n     *\n     * Returns:\n     *     TextEditorView:\n     *     The view corresponding to the editor.\n     */\n    getFromInlineEditor($editor) {\n        return $editor.inlineEditor('field').data('text-editor');\n    }\n});\n\n\n})();\n"]}
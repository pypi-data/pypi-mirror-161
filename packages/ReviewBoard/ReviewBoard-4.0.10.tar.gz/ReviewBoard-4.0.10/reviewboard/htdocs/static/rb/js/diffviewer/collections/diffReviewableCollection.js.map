{"version":3,"sources":["diffReviewableCollection.es6.js"],"names":[],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAAC,wBAAH,GAA8B,QAAQ,CAAC,UAAT,CAAoB,MAApB,CAA2B;EACrD,KAAK,EAAE,EAAE,CAAC,cAD2C;;EAGrD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,UAAU,CAAC,MAAD,EAAS,OAAT,EAAkB;IACxB,KAAK,aAAL,GAAqB,OAAO,CAAC,aAA7B;EACH,CAnBoD;;EAqBrD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,UAAU,CAAC,KAAD,EAAQ;IACd,KAAK,QAAL,CAAc,KAAd,EAAqB,OAArB,EAA8B,MAAM,KAAK,kBAAL,CAAwB,KAAxB,CAApC;;IACA,KAAK,kBAAL,CAAwB,KAAxB;EACH,CAlCoD;;EAoCrD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,kBAAkB,CAAC,KAAD,EAAQ;IACtB,MAAM,aAAa,GAAG,KAAK,aAA3B;IAEA,OAAO,CAAC,MAAR,CAAe,aAAf,EACe,uDADf;IAGA,KAAK,KAAL;IACA,KAAK,OAAL,CAAa,YAAb;IAEA,KAAK,CAAC,IAAN,CAAW,IAAI,IAAI;MACf,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAL,CAAS,UAAT,CAAjB;MACA,MAAM,aAAa,GAAG,IAAI,CAAC,GAAL,CAAS,eAAT,CAAtB;MACA,IAAI,iBAAiB,GAAG,IAAxB;;MAEA,IAAI,aAAJ,EAAmB;QACf,iBAAiB,GAAG,aAAa,CAAC,QAAlC;MACH,CAFD,MAEO,IAAI,IAAI,CAAC,GAAL,CAAS,gBAAT,CAAJ,EAAgC;QACnC,iBAAiB,GAAG,IAAI,CAAC,GAAL,CAAS,wBAAT,CAApB;MACH;;MAED,KAAK,GAAL,CAAS;QACL,cAAc,EAAE,IAAI,CAAC,GAAL,CAAS,gBAAT,CADX;QAEL,aAAa,EAAE,aAFV;QAGL,IAAI,EAAE,IAHD;QAIL,UAAU,EAAE,QAAQ,CAAC,EAJhB;QAKL,eAAe,EAAE,aAAa,GAAG,aAAa,CAAC,EAAjB,GAAsB,IAL/C;QAML,QAAQ,EAAE,QAAQ,CAAC,QANd;QAOL,iBAAiB,EAAE,iBAPd;QAQL,uBAAuB,EAAE,IAAI,CAAC,GAAL,CAAS,eAAT;MARpB,CAAT;IAUH,CArBD;IAuBA,KAAK,OAAL,CAAa,WAAb;EACH;;AAnFoD,CAA3B,CAA9B","file":"diffReviewableCollection.js","sourcesContent":["/**\n * A collection of RB.DiffReviewable instances.\n *\n * This manages a collection of :js:class:`RB.DiffReviewable`s and can\n * populate itself based on changes to a collection of files.\n *\n * When repopulating, this will emit a ``populating`` event. After populating,\n * it will emit a ``populated`` event.\n */\nRB.DiffReviewableCollection = Backbone.Collection.extend({\n    model: RB.DiffReviewable,\n\n    /**\n     * Initialize the collection.\n     *\n     * Args:\n     *     models (Array):\n     *         Optional array of models.\n     *\n     *     options (object):\n     *         Options for the collection.\n     *\n     * Option Args:\n     *     reviewRequest (RB.ReviewRequest):\n     *         The review request for the collection. This must be provided.\n     */\n    initialize(models, options) {\n        this.reviewRequest = options.reviewRequest;\n    },\n\n    /**\n     * Watch for changes to a collection of files.\n     *\n     * When the files change (and when invoking this method), this collection\n     * will be rebuilt based on those files.\n     *\n     * Args:\n     *     files (RB.DiffFileCollection):\n     *         The collection of files to watch.\n     */\n    watchFiles(files) {\n        this.listenTo(files, 'reset', () => this._populateFromFiles(files));\n        this._populateFromFiles(files);\n    },\n\n    /**\n     * Populate this collection from a collection of files.\n     *\n     * This will clear this collection and then loop through each file,\n     * adding a corresponding :js:class:`RB.DiffReviewable`.\n     *\n     * After clearing, but prior to adding any entries, this will emit a\n     * ``populating`` event. After all reviewables have been added, this\n     * will emit a ``populated`` event.\n     *\n     * Args:\n     *     files (RB.DiffFileCollection):\n     *         The collection of files to populate from.\n     */\n    _populateFromFiles(files) {\n        const reviewRequest = this.reviewRequest;\n\n        console.assert(reviewRequest,\n                       'RB.DiffReviewableCollection.reviewRequest must be set');\n\n        this.reset();\n        this.trigger('populating');\n\n        files.each(file => {\n            const filediff = file.get('filediff');\n            const interfilediff = file.get('interfilediff');\n            let interdiffRevision = null;\n\n            if (interfilediff) {\n                interdiffRevision = interfilediff.revision;\n            } else if (file.get('forceInterdiff')) {\n                interdiffRevision = file.get('forceInterdiffRevision');\n            }\n\n            this.add({\n                baseFileDiffID: file.get('baseFileDiffID'),\n                reviewRequest: reviewRequest,\n                file: file,\n                fileDiffID: filediff.id,\n                interFileDiffID: interfilediff ? interfilediff.id : null,\n                revision: filediff.revision,\n                interdiffRevision: interdiffRevision,\n                serializedCommentBlocks: file.get('commentCounts'),\n            });\n        });\n\n        this.trigger('populated');\n    },\n});\n"]}
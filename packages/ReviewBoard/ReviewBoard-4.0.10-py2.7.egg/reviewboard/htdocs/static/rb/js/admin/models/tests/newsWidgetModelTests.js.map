{"version":3,"sources":["newsWidgetModelTests.es6.js"],"names":[],"mappings":"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","file":"newsWidgetModelTests.js","sourcesContent":["suite('rb/admin/models/NewsWidget', function() {\n    let model;\n\n    beforeEach(function() {\n        model = new RB.Admin.NewsWidget({\n            rssURL: 'http://example.com/news/rss',\n        });\n    });\n\n    describe('Methods', function() {\n        describe('loadNews', function() {\n            it('Success', function() {\n                function _loadNews(url, options) {\n                    expect(url).toBe('http://example.com/news/rss');\n\n                    const payload = dedent`\n                        <?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n                        <rss xmlns:atom=\"http://www.w3.org/2005/Atom\"\n                             version=\"2.0\">\n                         <channel>\n                          <title>Channel Name</title>\n                          <link>http://example.com/news/</link>\n                          <description>Channel description...</description>\n                          <atom:link href=\"http://example.com/news/rss\"\n                                     rel=\"self\"></atom:link>\n                          <language>en-us</language>\n                          <lastBuildDate>Sun, 20 Oct 2019 17:26:32 -0700</lastBuildDate>\n                          <item>\n                           <title>Headline 6</title>\n                           <pubDate>Sun, 20 Oct 2019 17:26:32 -0700</pubDate>\n                           <link>http://example.com/news/post6</link>\n                           <description>Brief summary of 6</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post6</guid>\n                          </item>\n                          <item>\n                           <title>Headline 5</title>\n                           <pubDate>Tue, 01 Oct 2019 13:29:00 -0700</pubDate>\n                           <link>http://example.com/news/post5</link>\n                           <description>Brief summary of 5</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post5</guid>\n                          </item>\n                          <item>\n                           <title>Headline 4</title>\n                           <pubDate>Thu, 26 Sep 2019 19:29:33 -0700</pubDate>\n                           <link>http://example.com/news/post4</link>\n                           <description>Brief summary of 4</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post4</guid>\n                          </item>\n                          <item>\n                           <title>Headline 3</title>\n                           <pubDate>Sun, 08 Sep 2019 11:27:05 -0700</pubDate>\n                           <link>http://example.com/news/post3</link>\n                           <description>Brief summary of 3</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post3</guid>\n                          </item>\n                          <item>\n                           <title>Headline 2</title>\n                           <pubDate>Fri, 30 Aug 2019 23:15:01 -0700</pubDate>\n                           <link>http://example.com/news/post2</link>\n                           <description>Brief summary of 2</description>\n                           <author>user1@example.com</author>\n                           <guid>http://example.com/news/post2</guid>\n                          </item>\n                          <item>\n                           <title>Headline 1</title>\n                           <pubDate>Thu, 29 Aug 2019 14:30:00 -0700</pubDate>\n                           <link>http://example.com/news/post1</link>\n                           <description>Brief summary of 1</description>\n                           <author>user2@example.com</author>\n                           <guid>http://example.com/news/post1</guid>\n                          </item>\n                         </channel>\n                        </rss>\n                    `;\n\n                    const parser = new DOMParser();\n                    options.success(parser.parseFromString(payload,\n                                                           'application/xml'));\n                }\n\n                const loadingNewsEventHandler = jasmine.createSpy();\n\n                spyOn($, 'ajax').and.callFake(_loadNews);\n                model.on('loadingNews', loadingNewsEventHandler);\n\n                model.loadNews();\n\n                expect(loadingNewsEventHandler).toHaveBeenCalled();\n                expect($.ajax).toHaveBeenCalled();\n\n                const newsItems = model.get('newsItems');\n                expect(newsItems.length).toBe(5);\n\n                let newsItem = newsItems[0];\n                expect(newsItem.date.isSame(Date.UTC(2019, 9, 21, 0, 26, 32)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 6');\n                expect(newsItem.url).toBe('http://example.com/news/post6');\n\n                newsItem = newsItems[1];\n                expect(newsItem.date.isSame(Date.UTC(2019, 9, 1, 20, 29, 0)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 5');\n                expect(newsItem.url).toBe('http://example.com/news/post5');\n\n                newsItem = newsItems[2];\n                expect(newsItem.date.isSame(Date.UTC(2019, 8, 27, 2, 29, 33)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 4');\n                expect(newsItem.url).toBe('http://example.com/news/post4');\n\n                newsItem = newsItems[3];\n                expect(newsItem.date.isSame(Date.UTC(2019, 8, 8, 18, 27, 5)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 3');\n                expect(newsItem.url).toBe('http://example.com/news/post3');\n\n                newsItem = newsItems[4];\n                expect(newsItem.date.isSame(Date.UTC(2019, 7, 31, 6, 15, 1)))\n                    .toBeTrue();\n                expect(newsItem.title).toBe('Headline 2');\n                expect(newsItem.url).toBe('http://example.com/news/post2');\n            });\n\n            it('Error loading feed', function() {\n                function _loadNews(url, options) {\n                    expect(url).toBe('http://example.com/news/rss');\n                    options.error();\n                }\n\n                const loadingNewsEventHandler = jasmine.createSpy();\n\n                spyOn($, 'ajax').and.callFake(_loadNews);\n                model.on('loadingNews', loadingNewsEventHandler);\n\n                model.loadNews();\n\n                expect(loadingNewsEventHandler).toHaveBeenCalled();\n                expect($.ajax).toHaveBeenCalled();\n\n                const newsItems = model.get('newsItems');\n                expect(newsItems.length).toBe(0);\n            });\n        });\n    });\n});\n\n"]}
{"version":3,"sources":["centeredElementManager.es6.js"],"names":[],"mappings":"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","file":"centeredElementManager.js","sourcesContent":["/**\n * A view which ensures that the specified elements are vertically centered.\n */\nRB.CenteredElementManager = Backbone.View.extend({\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options passed to this view.\n     *\n     * Option Args:\n     *     elements (Array, optional):\n     *         An initial array of elements to center.\n     */\n    initialize(options={}) {\n        this._elements = options.elements || new Map();\n        this._$window = $(window);\n\n        this._updatePositionThrottled = _.throttle(() => this.updatePosition(),\n                                                   10);\n\n        this._$window.on('resize', this._updatePositionThrottled);\n        this._$window.on('scroll', this._updatePositionThrottled);\n    },\n\n    /**\n     * Remove the CenteredElementManager.\n     *\n     * This will result in the event handlers being removed.\n     */\n    remove() {\n        Backbone.View.prototype.remove.call(this);\n\n        this._$window.off('resize', this._updatePositionThrottled);\n        this._$window.off('scroll', this._updatePositionThrottled);\n    },\n\n    /**\n     * Set the elements and their containers.\n     *\n     * Args:\n     *     elements (Map<Element, Element or jQuery>):\n     *         The elements to center within their respective containers.\n     */\n    setElements(elements) {\n        this._elements = elements;\n    },\n\n    /**\n     * Update the position of the elements.\n     *\n     * This should only be done when the set of elements changed, as the view\n     * will handle updating on window resizing and scrolling.\n     */\n    updatePosition() {\n        if (this._elements.size === 0) {\n            return;\n        }\n\n        const windowTop = this._$window.scrollTop();\n        const windowHeight = this._$window.height();\n        const windowBottom = windowTop + windowHeight;\n\n        this._elements.forEach((containers, el) => {\n            const $el = $(el);\n            const $topContainer = containers.$top;\n            const $bottomContainer = containers.$bottom || $topContainer;\n            const containerTop = $topContainer.offset().top;\n            const containerBottom = $bottomContainer.offset().top +\n                                    $bottomContainer.height();\n\n            /*\n             * We don't have to vertically center the element when its\n             * container is not on screen.\n             */\n            if (containerTop < windowBottom && containerBottom > windowTop) {\n                /*\n                 * When a container takes up the entire viewport, we can switch\n                 * the CSS to use position: fixed. This way, we do not have to\n                 * re-compute its position.\n                 */\n                if (windowTop >= containerTop &&\n                    windowBottom <= containerBottom) {\n                    if ($el.css('position') !== 'fixed') {\n                        $el.css({\n                            position: 'fixed',\n                            left: $el.offset().left,\n                            top: Math.round(\n                                (windowHeight - $el.outerHeight()) / 2),\n                        });\n                    }\n                } else {\n                    const top = Math.max(windowTop, containerTop);\n                    const bottom = Math.min(windowBottom, containerBottom);\n                    const elTop = top - containerTop + Math.round(\n                        (bottom - top - $el.outerHeight()) / 2);\n\n                    $el.css({\n                        position: 'absolute',\n                        left: '',\n                        top: elTop,\n                    });\n                }\n            }\n        });\n    },\n});\n"]}
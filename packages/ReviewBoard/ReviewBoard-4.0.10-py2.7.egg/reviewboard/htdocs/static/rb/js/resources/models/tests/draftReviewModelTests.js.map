{"version":3,"sources":["draftReviewModelTests.es6.js"],"names":[],"mappings":"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","file":"draftReviewModelTests.js","sourcesContent":["suite('rb/resources/models/DraftReview', function() {\n    let model;\n    let parentObject;\n\n    beforeEach(function() {\n        parentObject = new RB.BaseResource({\n            links: {\n                reviews: {\n                    href: '/api/foos/'\n                },\n            },\n        });\n\n        model = new RB.DraftReview({\n            parentObject: parentObject,\n        });\n        model.rspNamespace = 'foo';\n    });\n\n    describe('Methods', function() {\n        let callbacks;\n\n        beforeEach(function() {\n            callbacks = {\n                ready: function() {},\n                success: function() {},\n                error: function() {},\n            };\n\n            spyOn(callbacks, 'ready');\n            spyOn(callbacks, 'success');\n            spyOn(callbacks, 'error');\n        });\n\n        describe('ready', function() {\n            beforeEach(function() {\n                spyOn(Backbone.Model.prototype, 'fetch')\n                    .and.callFake(options => {\n                        if (options && _.isFunction(options.success)) {\n                            options.success();\n                        }\n                    });\n                spyOn(parentObject, 'ready')\n                    .and.callFake((options, context) => {\n                        if (options && _.isFunction(options.ready)) {\n                            options.ready.call(context);\n                        }\n                    });\n                spyOn(model, '_retrieveDraft')\n                    .and.callFake((options, context) => {\n                        if (options && _.isFunction(options.ready)) {\n                            options.ready.call(context);\n                        }\n                    });\n            });\n\n            describe('With isNew=true', function() {\n                beforeEach(function() {\n                    expect(model.isNew()).toBe(true);\n                    expect(model.get('loaded')).toBe(false);\n                });\n\n                it('With callbacks', function() {\n                    model.ready(callbacks);\n\n                    expect(parentObject.ready).toHaveBeenCalled();\n                    expect(model._retrieveDraft).toHaveBeenCalled();\n                    expect(callbacks.ready).toHaveBeenCalled();\n                });\n            });\n\n            describe('With isNew=false', function() {\n                beforeEach(function() {\n                    model.set({\n                        id: 123,\n                    });\n                });\n\n                it('With callbacks', function() {\n                    model.ready(callbacks);\n\n                    expect(parentObject.ready).toHaveBeenCalled();\n                    expect(model._retrieveDraft).not.toHaveBeenCalled();\n                    expect(callbacks.ready).toHaveBeenCalled();\n                });\n            });\n        });\n\n        describe('publish', function() {\n            beforeEach(function() {\n                spyOn(model, 'save').and.callFake((options, context) => {\n                    options.success.call(context);\n                });\n            });\n\n            it('Triggers \"publishing\" event before publish', function() {\n                spyOn(model, 'trigger');\n                spyOn(model, 'ready');\n\n                model.publish();\n\n                expect(model.trigger).toHaveBeenCalledWith('publishing');\n            });\n\n            it('Triggers \"published\" event after publish', function() {\n                spyOn(model, 'trigger');\n\n                spyOn(model, 'ready').and.callFake((options, context) => {\n                    options.ready.call(context);\n                });\n\n                model.publish(callbacks);\n\n                expect(callbacks.success).toHaveBeenCalled();\n                expect(model.trigger).toHaveBeenCalledWith('published');\n            });\n\n            it('Sets \"public\" to true', function() {\n                spyOn(model, 'ready').and.callFake((options, context) => {\n                    options.ready.call(context);\n                });\n\n                expect(model.get('public')).toBe(false);\n\n                model.publish(callbacks);\n\n                expect(callbacks.success).toHaveBeenCalled();\n                expect(model.get('public')).toBe(true);\n            });\n        });\n    });\n});\n"]}
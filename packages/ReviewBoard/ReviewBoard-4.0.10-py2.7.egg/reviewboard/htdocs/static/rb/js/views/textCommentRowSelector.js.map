{"version":3,"sources":["textCommentRowSelector.es6.js"],"names":[],"mappings":"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","file":"textCommentRowSelector.js","sourcesContent":["/*\n * Provides multi-line commenting capabilities for a diff.\n *\n * This tacks on commenting capabilities onto a DiffReviewableView's\n * element. It listens for mouse events that begin/end the creation of\n * a new comment.\n */\nRB.TextCommentRowSelector = Backbone.View.extend({\n    ghostCommentFlagTemplate: dedent`\n        <span class=\"commentflag ghost-commentflag\">\n         <span class=\"commentflag-shadow\"></span>\n         <span class=\"commentflag-inner\"></span>\n        </span>\n    `,\n\n    events: {\n        'copy': '_onCopy',\n        'mousedown': '_onMouseDown',\n        'mouseup': '_onMouseUp',\n        'mouseover': '_onMouseOver',\n        'mouseout': '_onMouseOut',\n        'touchstart': '_onTouchStart',\n        'touchend': '_onTouchEnd',\n        'touchmove': '_onTouchMove',\n        'touchcancel': '_onTouchCancel',\n    },\n\n    /**\n     * Initialize the commenting selector.\n     *\n     * Args:\n     *     options (object):\n     *         Options for initializing the view.\n     *\n     * Option Args:\n     *     reviewableView (RB.AbstractReviewableView):\n     *         The view that will create the comment based on the selection we\n     *         provide.\n     */\n    initialize(options) {\n        this.options = options;\n        this._$begin = null;\n        this._$end = null;\n        this._beginLineNum = 0;\n        this._endLineNum = 0;\n        this._lastSeenIndex = 0;\n        this._selectionClass = null;\n\n        /*\n         * Support setting the clipboard only if we have the necessary\n         * functions. This may still be turned off later if we can't\n         * actually set the data.\n         */\n        this._supportsSetClipboard = (\n            window.getSelection !== undefined &&\n            window.Range !== undefined &&\n            window.Range.prototype.cloneContents !== undefined);\n\n        this._newlineChar = null;\n\n        this._$ghostCommentFlag = null;\n        this._$ghostCommentFlagCell = null;\n    },\n\n    /**\n     * Remove the selector from the DOM.\n     */\n    remove() {\n        Backbone.View.prototype.remove.call(this);\n\n        this._$ghostCommentFlag.remove();\n    },\n\n    /**\n     * Render the selector.\n     *\n     * Returns:\n     *     RB.TextCommentRowSelector:\n     *     This object, for chaining.\n     */\n    render() {\n        this._$ghostCommentFlag = $(this.ghostCommentFlagTemplate)\n            .on({\n                mousedown: _.bind(this._onMouseDown, this),\n                mouseup: _.bind(this._onMouseUp, this),\n                mouseover: _.bind(this._onMouseOver, this),\n                mouseout: _.bind(this._onMouseOut, this)\n            })\n            .hide()\n            .appendTo('body');\n\n        return this;\n    },\n\n   /**\n    * Create a comment for a chunk of a diff.\n    *\n    * Args:\n    *     beginLineNum (number):\n    *         The first line number of the range being commented upon.\n    *\n    *     endLineNum (number):\n    *         The last line number of the range being commented upon.\n    *\n    *     beginNode (Element):\n    *         The element for the first row of the range being commented on.\n    *\n    *     endNode (Element):\n    *         The element of the last row of the range being commented on.\n    */\n    createComment(beginLineNum, endLineNum, beginNode, endNode) {\n        this._beginLineNum = beginLineNum;\n        this._endLineNum = endLineNum;\n        this._$begin = this._getActualLineNumCell($(beginNode)).parent();\n        this._$end = this._getActualLineNumCell($(endNode)).parent();\n\n        if (this._isLineNumCell(endNode)) {\n            this._end(this._getActualLineNumCell($(endNode)).parent());\n        }\n\n        this._reset();\n    },\n\n    /**\n     * Return the beginning and end rows for a given line number range.\n     *\n     * Args:\n     *      beginLineNum (number):\n     *         The first line number of the range.\n     *\n     *      endLineNum (number):\n     *         The last line number of the range.\n     *\n     *      minRowIndex (number):\n     *         A minimum row index to constrain the search to.\n     *\n     *         No rows with indices less than this will be searched.\n     *\n     * Returns:\n     *     array of Element:\n     *     If the row corresponding to ``beginLineNum`` cannot be found, the\n     *     return value with be ``null``.\n     *\n     *     Otherwise, this will be a 2 element array containing:\n     *\n     *     * The :js:class:`Element` for the row corresponding to\n     *       ``beginLineNum``.\n     *     * The :js:class:`Element` for the row corresponding to\n     *       ``endLineNum``, or ``null`` if it cannot be found.\n     */\n    getRowsForRange(beginLineNum, endLineNum, minRowIndex) {\n        const beginRowEl = this.findLineNumRow(beginLineNum, minRowIndex);\n\n        if (beginRowEl) {\n            const rowIndex = beginRowEl.rowIndex;\n            const endRowEl = (\n                endLineNum === beginLineNum\n                ? beginRowEl\n                : this.findLineNumRow(\n                    endLineNum,\n                    rowIndex,\n                    rowIndex + endLineNum - beginLineNum)\n            );\n\n            return [beginRowEl, endRowEl];\n        } else {\n            return null;\n        }\n    },\n\n    /**\n     * Find the row in a table matching the specified line number.\n     *\n     * This will perform a binary search of the lines trying to find\n     * the matching line number. It will then return the row element,\n     * if found.\n     *\n     * Args:\n     *     lineNum (number):\n     *         The line number to find.\n     *\n     *     startRow (number):\n     *         The index of the row to start the search at.\n     *\n     *     endRow (number):\n     *         The index of the row to end the sarch at.\n     */\n    findLineNumRow(lineNum, startRow, endRow) {\n        const table = this.el;\n        const rowOffset = 1; // Get past the headers.\n        let row = null;\n\n        if (table.rows.length - rowOffset > lineNum) {\n            row = table.rows[rowOffset + lineNum];\n\n            // Account for the \"x lines hidden\" row.\n            if (row && this.getLineNum(row) === lineNum) {\n                return row;\n            }\n        }\n\n        if (startRow) {\n            // startRow already includes the offset, so we need to remove it.\n            startRow -= rowOffset;\n        }\n\n        let low = startRow || 0;\n        let high = Math.min(endRow || table.rows.length, table.rows.length);\n\n        if (endRow !== undefined && endRow < table.rows.length) {\n            // See if we got lucky and found it in the last row.\n            if (this.getLineNum(table.rows[endRow]) === lineNum) {\n                return table.rows[endRow];\n            }\n        } else if (row !== null) {\n            /*\n             * We collapsed the rows (unless someone mucked with the DB),\n             * so the desired row is less than the row number retrieved.\n             */\n            high = Math.min(high, rowOffset + lineNum);\n        }\n\n        // Binary search for this cell.\n        for (let i = Math.round((low + high) / 2); low < high - 1;) {\n            row = table.rows[rowOffset + i];\n\n            if (!row) {\n                // This should not happen, unless we miscomputed high.\n                high--;\n\n                /*\n                 * This won't do much if low + high is odd, but we'll catch\n                 * up on the next iteration.\n                 */\n                i = Math.round((low + high) / 2);\n                continue;\n            }\n\n            let value = this.getLineNum(row);\n\n            if (!value) {\n                /*\n                 * Bad luck, let's look around.\n                 *\n                 * We'd expect to find a value on the first try, but the\n                 * following makes sure we explore all rows.\n                 */\n                let found = false;\n\n                for (let j = 1; j <= (high - low) / 2; j++) {\n                    row = table.rows[rowOffset + i + j];\n\n                    if (row && this.getLineNum(row)) {\n                        i = i + j;\n                        found = true;\n                        break;\n                    } else {\n                        row = table.rows[rowOffset + i - j];\n\n                        if (row && this.getLineNum(row)) {\n                            i = i - j;\n                            found = true;\n                            break;\n                        }\n                    }\n                }\n\n                if (found) {\n                    value = this.getLineNum(row);\n                } else {\n                    return null;\n                }\n            }\n\n            // See if we can use simple math to find the row quickly.\n            const guessRowNum = lineNum - value + rowOffset + i;\n\n            if (guessRowNum >= 0 && guessRowNum < table.rows.length) {\n                const guessRow = table.rows[guessRowNum];\n\n                if (guessRow && this.getLineNum(guessRow) === lineNum) {\n                    // We found it using maths!\n                    return guessRow;\n                }\n            }\n\n            const oldHigh = high;\n            const oldLow = low;\n\n            if (value > lineNum) {\n                high = i;\n            } else if (value < lineNum) {\n                low = i;\n            } else {\n                return row;\n            }\n\n            /*\n             * Make sure we don't get stuck in an infinite loop. This can happen\n             * when a comment is placed in a line that isn't being shown.\n             */\n            if (oldHigh === high && oldLow === low) {\n                break;\n            }\n\n            i = Math.round((low + high) / 2);\n        }\n\n        // Well.. damn. Ignore this then.\n        return null;\n    },\n\n    /**\n     * Begin the selection of line numbers.\n     *\n     * Args:\n     *     $row (jQuery):\n     *         The selected row.\n     */\n    _begin($row) {\n        const lineNum = this.getLineNum($row[0]);\n\n        this._$begin = $row;\n        this._$end = $row;\n        this._beginLineNum = lineNum;\n        this._endLineNum = lineNum;\n        this._lastSeenIndex = $row[0].rowIndex;\n\n        $row.addClass('selected');\n        this.$el.disableSelection();\n    },\n\n    /**\n     * Finalize the selection and pop up a comment dialog.\n     *\n     * Args:\n     *     $row (jQuery):\n     *         The selected row.\n     */\n    _end($row) {\n        if (this._beginLineNum === this._endLineNum) {\n            /* See if we have a comment flag on the selected row. */\n            const $commentFlag = $row.find('.commentflag');\n\n            if ($commentFlag.length === 1) {\n                $commentFlag.click();\n                return;\n            }\n        }\n\n        /*\n         * Selection was finalized. Create the comment block\n         * and show the comment dialog.\n         */\n        this.options.reviewableView.createAndEditCommentBlock({\n            beginLineNum: this._beginLineNum,\n            endLineNum: this._endLineNum,\n            $beginRow: this._$begin,\n            $endRow: this._$end\n        });\n    },\n\n    /**\n     * Add a row to the selection.\n     *\n     * This will update the selection range and mark the rows as selected.\n     *\n     * This row is assumed to be the most recently selected row, and\n     * will mark the new beginning or end of the selection.\n     *\n     * Args:\n     *     $row (jQuery):\n     *         The row to add to the selection.\n     */\n    _addRow($row) {\n        /* We have an active selection. */\n        const lineNum = this.getLineNum($row[0]);\n\n        if (lineNum < this._beginLineNum) {\n            this._$begin = $row;\n            this._beginLineNum = lineNum;\n        } else if (lineNum > this._beginLineNum) {\n            this._$end = $row;\n            this._endLineNum = lineNum;\n        }\n\n        const min = Math.min(this._lastSeenIndex, $row[0].rowIndex);\n        const max = Math.max(this._lastSeenIndex, $row[0].rowIndex);\n\n        for (let i = min; i <= max; i++) {\n            $(this.el.rows[i]).addClass('selected');\n        }\n\n        this._lastSeenIndex = $row[0].rowIndex;\n    },\n\n    /**\n     * Highlight a row.\n     *\n     * This will highlight a row and show a ghost comment flag. This is done\n     * when the mouse hovers over the row.\n     *\n     * Args:\n     *     $row (jQuery):\n     *         The row to highlight.\n     */\n    _highlightRow($row) {\n        const $lineNumCell = $($row[0].cells[0]);\n\n        /* See if we have a comment flag in here. */\n        if ($lineNumCell.find('.commentflag').length === 0) {\n            this._$ghostCommentFlag\n                .css('top', $row.offset().top - 1)\n                .show()\n                .parent()\n                    .removeClass('selected');\n            this._$ghostCommentFlagCell = $lineNumCell;\n        }\n\n        $row.addClass('selected');\n    },\n\n    /**\n     * Remove old rows from the selection based on the most recent selection.\n     *\n     * Args:\n     *     $row (jQuery):\n     *         The most recent row selection.\n     */\n    _removeOldRows($row) {\n        const destRowIndex = $row[0].rowIndex;\n\n        if (destRowIndex >= this._$begin[0].rowIndex) {\n            if (this._lastSeenIndex !== this._$end[0].rowIndex &&\n                this._lastSeenIndex < destRowIndex) {\n                /*\n                 * We're removing from the top of the range. The beginning\n                 * location will need to be moved.\n                 */\n                this._removeSelectionClasses(this._lastSeenIndex, destRowIndex);\n                this._$begin = $row;\n                this._beginLineNum = this.getLineNum($row[0]);\n            } else {\n                /*\n                 * We're removing from the bottom of the selection. The end\n                 * location will need to be moved.\n                 */\n                this._removeSelectionClasses(destRowIndex,\n                                             this._lastSeenIndex);\n\n                this._$end = $row;\n                this._endLineNum = this.getLineNum($row[0]);\n            }\n\n            this._lastSeenIndex = destRowIndex;\n        }\n    },\n\n    /**\n     * Reset the selection information.\n     */\n    _reset() {\n        if (this._$begin) {\n            /* Reset the selection. */\n            this._removeSelectionClasses(this._$begin[0].rowIndex,\n                                         this._$end[0].rowIndex);\n\n            this._$begin = null;\n            this._$end = null;\n            this._beginLineNum = 0;\n            this._endLineNum = 0;\n            this._lastSeenIndex = 0;\n        }\n\n        this._$ghostCommentFlagCell = null;\n\n        /* Re-enable text selection on IE */\n        this.$el.enableSelection();\n    },\n\n    /**\n     * Remove the selection classes on a range of rows.\n     *\n     * Args:\n     *     startRowIndex (number):\n     *         The row index to start removing selection classes at.\n     *\n     *     endRowIndex (number):\n     *         The row index to stop removing selection classes at.\n     */\n    _removeSelectionClasses(startRowIndex, endRowIndex) {\n        for (let i = startRowIndex; i <= endRowIndex; i++) {\n            $(this.el.rows[i]).removeClass('selected');\n        }\n    },\n\n    /**\n     * Return whether a particular cell is a line number cell.\n     *\n     * Args:\n     *     cell (Element):\n     *         The cell to inspect.\n     */\n    _isLineNumCell(cell) {\n        return cell.tagName === 'TH' &&\n               cell.parentNode.getAttribute('line');\n    },\n\n    /**\n     * Return the actual cell node in the table.\n     *\n     * If the node specified is the ghost flag, this will return the\n     * cell the ghost flag represents.\n     *\n     * If this is a comment flag inside a cell, this will return the\n     * comment flag's parent cell\n     *\n     * Returns:\n     *     jQuery:\n     *     The row.\n     */\n    _getActualLineNumCell($node) {\n        if ($node.hasClass('commentflag')) {\n            if ($node[0] === this._$ghostCommentFlag[0]) {\n                return this._$ghostCommentFlagCell;\n            } else {\n                return $node.parent();\n            }\n        }\n\n        return $node;\n    },\n\n    /**\n     * Handler for when the user copies text in a column.\n     *\n     * This will begin the process of capturing any selected text in\n     * a column to the clipboard in a cross-browser way.\n     */\n    _onCopy(e) {\n        const clipboardData = e.originalEvent.clipboardData ||\n                              window.clipboardData;\n\n        if (clipboardData && this._supportsSetClipboard &&\n            this._copySelectionToClipboard(clipboardData)) {\n            /*\n             * Prevent the default copy action from occurring.\n             */\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    },\n\n    /**\n     * Find the pre tags and push them into the result array.\n     *\n     * Args:\n     *     result (array):\n     *         The array for which all matching ``<pre>`` elements will be\n     *         pushed into.\n     *\n     *     parentEl (Element):\n     *         The parent element to search under.\n     *\n     *     tdClass (string):\n     *         The class of ``<td>`` elements to search.\n     *\n     *     excludeTBodyClass (string):\n     *         The class of the ``<tbody>`` to exclude.\n     */\n    _findPreTags(result, parentEl, tdClass, excludeTBodyClass) {\n        for (let i = 0; i < parentEl.children.length; i++) {\n            const node = parentEl.children[i];\n\n            if (node.nodeType === Node.ELEMENT_NODE) {\n                if (node.tagName === 'PRE') {\n                    result.push(node);\n                } else if ((node.tagName !== 'TD' ||\n                            $(node).hasClass(tdClass)) &&\n                           (node.tagName !== 'TBODY' ||\n                            !$(node).hasClass(excludeTBodyClass))) {\n                    findPreTags(result, node, tdClass, excludeTBodyClass);\n                }\n            }\n        }\n    },\n\n    /**\n     * Copy the current selection to the clipboard.\n     *\n     * This will locate the desired text to copy, based on the selection\n     * range within the column where selection started. It will then\n     * extract the code from the ``<pre>`` tags and build a string to set in\n     * the clipboard.\n     *\n     * This requires support in the browser for setting clipboard contents\n     * on copy. If the browser does not support this, the default behavior\n     * will be used.\n     *\n     * Args:\n     *     clipboardData (DataTransfer):\n     *         The clipboard data from the copy event.\n     *\n     * Returns:\n     *     boolean:\n     *     Whether or not we successfully set the clipboard data.\n     */\n    _copySelectionToClipboard(clipboardData) {\n        let excludeTBodyClass;\n        let tdClass;\n\n        if (this._newlineChar === null) {\n            /*\n             * Figure out what newline character should be used on this\n             * platform. Ideally, we'd determine this from some browser\n             * behavior, but it doesn't seem that can be consistently\n             * determined.\n             */\n            if (navigator.appVersion.includes('Win')) {\n                this._newlineChar = '\\r\\n';\n            } else {\n                this._newlineChar = '\\n';\n            }\n        }\n\n        if (this._selectedCellIndex === 3 || this.$el.hasClass('newfile')) {\n            tdClass = 'r';\n            excludeTBodyClass = 'delete';\n        } else {\n            tdClass = 'l';\n            excludeTBodyClass = 'insert';\n        }\n\n        const sel = window.getSelection();\n        const textParts = [];\n\n        for (let i = 0; i < sel.rangeCount; i++) {\n            const range = sel.getRangeAt(i);\n\n            if (range.collapsed) {\n                continue;\n            }\n\n            const nodes = [];\n            const doc = range.cloneContents();\n            findPreTags(nodes, doc, tdClass, excludeTBodyClass);\n\n            if (nodes.length > 0) {\n                /*\n                 * The selection spans multiple rows. Find the blocks of text\n                 * in the column we want, and copy those to the clipboard.\n                 */\n                for (let j = 0; j < nodes.length; j++) {\n                    textParts.push(nodes[j].textContent);\n                }\n            } else {\n                /*\n                 * If we're here, then we selected a subset of a single\n                 * cell. There was only one Range, and no <pre> tags as\n                 * part of it. We can just grab the text of the document.\n                 *\n                 * (We don't really need to break here, but we're going to\n                 * in order to be clear that we're completely done.)\n                 */\n                textParts.push($(doc).text());\n                break;\n            }\n        }\n\n        try {\n            clipboardData.setData('text', textParts.join(this._newlineChar));\n        } catch (e) {\n            /* Let the native behavior take over. */\n            this._supportsSetClipboard = false;\n            return false;\n        }\n\n        return true;\n    },\n\n    /**\n     * Handle the mouse down event, which begins selection for comments.\n     *\n     * Args:\n     *     e (jQuery.Event):\n     *         The ``mousedown`` event.\n     */\n    _onMouseDown(e) {\n        if (this._selectionClass) {\n            this.$el.removeClass(this._selectionClass);\n        }\n\n        const node = this._$ghostCommentFlagCell\n                   ? this._$ghostCommentFlagCell[0]\n                   : e.target;\n\n        if (this._isLineNumCell(node)) {\n            this._begin($(node.parentNode));\n        } else {\n            const $node = node.tagName === 'TD'\n                      ? $(node)\n                      : $(node).parentsUntil('tr', 'td');\n\n            if ($node.length > 0) {\n                this._selectionClass = 'selecting-col-' + $node[0].cellIndex;\n                this._selectedCellIndex = $node[0].cellIndex;\n                this.$el.addClass(this._selectionClass);\n            }\n        }\n    },\n\n    /**\n     * Handle the mouse up event.\n     *\n     * This will finalize the selection of a range of lines, creating a new\n     * comment block and displaying the dialog.\n     *\n     * Args:\n     *     e (jQuery.Event):\n     *         The ``mouseup`` event.\n     */\n    _onMouseUp(e) {\n        const node = this._$ghostCommentFlagCell\n                   ? this._$ghostCommentFlagCell[0]\n                   : e.target;\n\n        if (this._isLineNumCell(node)) {\n            this._end(this._getActualLineNumCell($(node)).parent());\n            e.stopImmediatePropagation();\n        }\n\n        this._reset();\n    },\n\n    /**\n     * Handle the mouse over event.\n     *\n     * This will update the selection, if there is one, to include this row\n     * in the range, and set the \"selected\" class on the new row.\n     *\n     * Args:\n     *     e (jQuery.Event):\n     *         The ``mouseover`` event.\n     */\n    _onMouseOver(e) {\n        const $node = this._getActualLineNumCell($(e.target));\n        const $row = $node.parent();\n\n        if (this._isLineNumCell($node[0])) {\n            if (this._$begin) {\n                this._addRow($row);\n            } else {\n                this._highlightRow($row);\n            }\n        } else if (this._$ghostCommentFlagCell &&\n                   $node[0] !== this._$ghostCommentFlagCell[0]) {\n            $row.removeClass('selected');\n        }\n    },\n\n    /**\n     * Handle the mouse out event.\n     *\n     * This will remove any lines outside the new range from the selection.\n     *\n     * Args:\n     *     e (jQuery.Event):\n     *         The ``mouseout`` event.\n     */\n    _onMouseOut(e) {\n        const relTarget = e.relatedTarget;\n\n        if (relTarget !== this._$ghostCommentFlag[0]) {\n            this._$ghostCommentFlag.hide();\n            this._$ghostCommentFlagCell = null;\n        }\n\n        const $node = this._getActualLineNumCell($(e.target));\n\n        if (this._$begin) {\n            if (relTarget && this._isLineNumCell(relTarget)) {\n                this._removeOldRows($(relTarget.parentNode));\n            }\n        } else if ($node && this._isLineNumCell($node[0])) {\n            /*\n             * Opera seems to generate lots of spurious mouse-out\n             * events, which would cause us to get all sorts of\n             * errors in here unless we check the target above.\n             */\n            $node.parent().removeClass('selected');\n        }\n    },\n\n    /**\n     * Handle the beginning of a touch event.\n     *\n     * If the user is touching a line number, then this will begin tracking\n     * a new comment selection state, allowing them to either open an existing\n     * comment or create a new one.\n     *\n     * Args:\n     *     e (jQuery.Event):\n     *         The ``touchstart`` event.\n     */\n    _onTouchStart(e) {\n        const firstTouch = e.originalEvent.targetTouches[0];\n        const $node = this._getActualLineNumCell($(firstTouch.target));\n\n        if ($node !== null && this._isLineNumCell($node[0])) {\n            e.preventDefault();\n            this._begin($node.parent());\n        }\n    },\n\n    /**\n     * Handle the end of a touch event.\n     *\n     * If the user ended on a line number, then this will either open an\n     * existing comment (if the result was a single-line selection on the\n     * line of an existing comment) or create a new comment spanning all\n     * selected lines.\n     *\n     * If they ended outside of the line numbers column, then this will\n     * simply reset the selection.\n     *\n     * Args:\n     *     e (jQuery.Event):\n     *         The ``touchend`` event.\n     */\n    _onTouchEnd(e) {\n        const firstTouch = e.originalEvent.changedTouches[0];\n        const target = document.elementFromPoint(firstTouch.clientX,\n                                                 firstTouch.clientY);\n        const $node = this._getActualLineNumCell($(target));\n\n        if ($node !== null && this._isLineNumCell($node[0])) {\n            e.preventDefault();\n            this._end($node.parent());\n        }\n\n        this._reset();\n    },\n\n    /**\n     * Handle touch movement events.\n     *\n     * If selecting up or down line numbers, this will update the selection\n     * to span all rows from the original line number first touched and the\n     * line number currently being touched.\n     *\n     * Args:\n     *     e (jQuery.Event):\n     *         The ``touchmove`` event.\n     */\n    _onTouchMove(e) {\n        const firstTouch = e.originalEvent.targetTouches[0];\n        const target = document.elementFromPoint(firstTouch.clientX,\n                                                 firstTouch.clientY);\n        const $node = this._getActualLineNumCell($(target));\n\n        if ($node !== null) {\n            const $row = $node.parent();\n\n            if (this._lastSeenIndex !== $row[0].rowIndex &&\n                this._isLineNumCell($node[0])) {\n                e.preventDefault();\n\n                this._removeOldRows($row);\n                this._addRow($row);\n            }\n        }\n    },\n\n    /**\n     * Handle touch cancellation events.\n     *\n     * This resets the line number selection. The user will need to begin the\n     * selection again.\n     */\n    _onTouchCancel() {\n        this._reset();\n    },\n\n    /**\n     * Return the line number for a row.\n     *\n     * Args:\n     *     row (Element):\n     *         The element to get the line number for.\n     *\n     * Returns:\n     *     number:\n     *     The line number.\n     */\n    getLineNum(row) {\n        return parseInt(row.getAttribute('line'), 10);\n    },\n});\n"]}
{"version":3,"sources":["relatedUserSelectorViewTests.es6.js"],"names":[],"mappings":"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","file":"relatedUserSelectorViewTests.js","sourcesContent":["suite('rb/admin/views/relatedUserSelectorView', function() {\n    describe('Rendering', function() {\n        it('when empty', function() {\n            let view = new RB.RelatedUserSelectorView({\n                $input: $('<input id=\"id_people\" type=\"hidden\">'),\n                initialOptions: [],\n                useAvatars: true,\n                multivalued: true\n            });\n            expect(view.options.useAvatars).toBe(true);\n            expect(view.options.multivalued).toBe(true);\n            view.render();\n\n            expect(view.$el.find('.related-object-selected li').length)\n                .toBe(0);\n        });\n    });\n\n    describe('Rendering', function() {\n        it('with inital options', function() {\n            let view = new RB.RelatedUserSelectorView({\n                $input: $('<input id=\"id_people\" type=\"hidden\">'),\n                initialOptions: [{\n                    username: 'admin',\n                    fullname: 'Admin User',\n                    id: 1,\n                    avatarHTML: {\n                        '20': '<div class=\"avatar\" alt=\"Admin User\"></div>',\n                    },\n                }, {\n                    username: 'doc',\n                    fullname: \"Doc Dwarf\",\n                    id: 2,\n                    avatarHTML: {\n                        '20': '<div class=\"avatar\" alt=\"Doc Dwarf\"></div>',\n                    },\n                }, {\n                    username: 'dopey',\n                    fullname: 'Dopey Dwarf',\n                    id: 3,\n                    avatarHTML: {\n                        '20': '<div class=\"avatar\" alt=\"Dopey Dwarf\"></div>',\n                    },\n                }],\n                useAvatars: true,\n                multivalued: true,\n            });\n            view.render();\n            expect(view.options.useAvatars).toBe(true);\n            expect(view.options.multivalued).toBe(true);\n\n            expect(view.$el.find('.related-object-selected li').length)\n                .toBe(3);\n            expect(view.$el.siblings('#id_people').val()).toBe('');\n            /* The input element value should be empty, since the widget will\n               not fill in the values from the objects if the objects are\n               passed through initialOptions. */\n            expect(view._selectedIDs.size).toBe(3);\n        });\n    });\n\n    describe('Select item', function() {\n        let view;\n\n        beforeEach(function(done) {\n            $testsScratch.append('<input id=\"id_people\" type=\"hidden\">');\n            view = new RB.RelatedUserSelectorView({\n                $input: $('#id_people'),\n                initialOptions: [],\n                useAvatars: true,\n                multivalued: true\n            });\n            view.render();\n\n            /* These are the fake users, that will be displayed in the\n               dropdown */\n            spyOn(view, 'loadOptions').and.callFake(function(query, callback) {\n                callback([{\n                    avatarHTML: {\n                        '20': '<div class=\"avatar\" alt=\"Admin User\"></div>',\n                    },\n                    fullname: 'Admin User',\n                    id: 1,\n                    username: 'admin',\n                }, {\n                    avatarHTML: {\n                        '20': '<div class=\"avatar\" alt=\"Doc Dwarf\"></div>',\n                    },\n                    fullname: 'Doc Dwarf',\n                    id: 2,\n                    username: 'doc',\n                }]);\n            });\n\n            $('select')[0].selectize.focus();\n            /* The focus() method is being called asynchronously, so it\n              doesn't actually call the loadOptions() method here\n              instantly. That's why I use setTimeout to wait for it to\n              finish. */\n            setTimeout(function() {\n                $testsScratch.find('div .selectize-input.items.not-full input').click();\n                done();\n            }, 4000);\n            /* I probably shouldn't be doing this, but I\n            don't know how else to get it to work. */\n        });\n\n        it('from dropdown', function(done) {\n            expect(view.loadOptions).toHaveBeenCalled();\n            $(\"div[data-value='admin']\").click();\n            $(\"div[data-value='doc']\").click();\n            expect(view.$el.siblings('#id_people').val()).toBe('1,2');\n            done();\n        });\n    });\n\n\n});"]}
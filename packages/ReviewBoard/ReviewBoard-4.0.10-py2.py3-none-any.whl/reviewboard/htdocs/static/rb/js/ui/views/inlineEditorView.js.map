{"version":3,"sources":["inlineEditorView.es6.js"],"names":[],"mappings":"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","file":"inlineEditorView.js","sourcesContent":["/**\n * A view for inline editors.\n *\n * This provides the framework for items which are \"editable\". These provide a\n * way to switch between a normal view and an edit view, which is usually a\n * text box (either single- or multiple-line).\n */\nRB.InlineEditorView = Backbone.View.extend({\n    /**\n     * Defaults for the view options.\n     */\n    defaultOptions: {\n        animationSpeedMS: 200,\n        deferEventSetup: false,\n        editIconPath: null,\n        editIconClass: null,\n        enabled: true,\n        extraHeight: 100,\n        focusOnOpen: true,\n        formatResult: value => value.htmlEncode(),\n        formClass: '',\n        getFieldValue: editor => editor.$field.val(),\n        hasRawValue: false,\n        isFieldDirty: (editor, initialValue) => {\n            const value = editor.getValue() || '';\n            const normValue = (editor.options.hasRawValue\n                               ? value\n                               : value.htmlEncode()) || '';\n            initialValue = editor.normalizeText(initialValue);\n\n            return (normValue.length !== initialValue.length ||\n                    normValue !== initialValue);\n        },\n        matchHeight: true,\n        multiline: false,\n        notifyUnchangedCompletion: false,\n        promptOnCancel: true,\n        rawValue: null,\n        setFieldValue: (editor, value) => editor.$field.val(value),\n        showButtons: true,\n        showEditIcon: true,\n        showRequiredFlag: false,\n        startOpen: false,\n    },\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     animationSpeedMS (number, optional):\n     *         The duration of animated transitions, in milliseconds.\n     *\n     *     deferEventSetup (boolean, optional):\n     *         Whether to defer event setup after rendering. This should be\n     *         used when a consumer wants to prioritize event handling (such as\n     *         handling the \"enter\" key for autocomplete).\n     *\n     *     editIconClass (string, optional):\n     *         The class name to use for the edit icon, when the icon is\n     *         created via CSS rules. This is only used if ``editIconPath`` is\n     *         unspecified.\n     *\n     *     editIconPath (string, optional):\n     *         The path for an image for the edit icon.\n     *\n     *     enabled (boolean):\n     *         Whether editing is enabled.\n     *\n     *     extraHeight (number, optional):\n     *         Extra height to add when displaying the editor, in pixels.\n     *\n     *     focusOnOpen (boolean, optional):\n     *         Whether to focus the field when opening the editor.\n     *\n     *     formatResult (function, optional):\n     *         A function to format the resulting value after editing back\n     *         into the element.\n     *\n     *     formClass (string, optional):\n     *         The class to add to the form's DOM element.\n     *\n     *     getFieldValue (function, optional):\n     *         A function to retrieve the field value.\n     *\n     *     hasRawValue (boolean, optional):\n     *         Whether the field has a \"raw value\", which is data for the field\n     *         separate from the actual contents of the element.\n     *\n     *     isFieldDirty (function, optional):\n     *         A function to calculate whether the editor value is dirty.\n     *\n     *     matchHeight (boolean, optional):\n     *         Whether to attempt to match the height of the editor and the\n     *         element it's replacing.\n     *\n     *     multiline (boolean, optional):\n     *         Whether the text input should be multi-line or single-line.\n     *\n     *     notifyUnchangedCompletion (boolean, optional):\n     *         Whether the editor should trigger a ``complete`` event even if\n     *         the value was unchanged. If this is ``false``, the editor will\n     *         trigger a ``cancel`` event instead.\n     *\n     *     promptOnCancel (boolean, optional):\n     *         Whether to prompt the user before cancelling if the editor is\n     *         dirty.\n     *\n     *     rawValue (*, optional):\n     *         When ``hasRawValue`` is ``true``, this provides the data for the\n     *         raw value of the item being edited.\n     *\n     *     setFieldValue (function, optional):\n     *         A function to set the field value.\n     *\n     *     showButtons (boolean, optional):\n     *         Whether to show OK/Cancel buttons.\n     *\n     *     showEditIcon (boolean, optional):\n     *         Whether to show the edit icon.\n     *\n     *     showRequiredFlag (boolean, optional):\n     *         Whether to show the required flag on the edit icon.\n     *\n     *     startOpen (boolean, optional):\n     *         Whether the editor should be open when first created.\n     *\n     *     stripTags (boolean, optional):\n     *         Whether to strip out HTML tags when normalizing input.\n     *\n     *     useEditIconOnly (boolean, optional):\n     *         Whether the editor can be opened only by clicking on the edit\n     *         icon. If false, clicking on the field value will also trigger an\n     *         edit.\n     */\n    initialize(options) {\n        this.options = _.defaults(options, this.defaultOptions);\n        this._initialValue = null;\n        this._editing = false;\n        this._dirty = false;\n        this._dirtyCalcTimeout = null;\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.InlineEditorView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el.data('inline-editor', this);\n\n        this._$form = $('<form>')\n            .addClass(`inline-editor-form ${this.options.formClass}`)\n            .css('display', 'inline')\n            .hide()\n            .insertBefore(this.$el);\n\n        this.$field = this.createField()\n            .prependTo(this._$form);\n        this._isTextArea = (this.$field[0].tagName === 'TEXTAREA');\n\n        this.$buttons = $();\n\n        if (this.options.showButtons) {\n            this.$buttons = $(this.options.multiline ? '<div>' : '<span>')\n                .hide()\n                .addClass('buttons')\n                .appendTo(this._$form);\n\n            $('<input type=\"button\" class=\"save\">')\n                .val(gettext('OK'))\n                .appendTo(this.$buttons)\n                .click(this.submit.bind(this));\n\n            $('<input type=\"button\" class=\"cancel\">')\n                .val(gettext('Cancel'))\n                .appendTo(this.$buttons)\n                .click(this.cancel.bind(this));\n        }\n\n        this._$editIcon = $();\n\n        if (this.options.showEditIcon) {\n            const editText = gettext('Edit this field');\n            this._$editIcon = $('<a class=\"editicon\" href=\"#\" role=\"button\">')\n                .attr({\n                    'title': editText,\n                    'aria-label': editText,\n                })\n                .click(e => {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    this.startEdit();\n                });\n\n            if (this.options.editIconPath) {\n                this._$editIcon.append(\n                    `<img src=\"${this.options.editIconPath}\">`);\n            } else if (this.options.editIconClass) {\n                this._$editIcon.append(\n                    `<div class=\"${this.options.editIconClass}\" aria-hidden=\"true\"></div>`);\n            }\n\n            if (this.options.showRequiredFlag) {\n                const requiredText = gettext('This field is required');\n                $('<span class=\"required-flag\">*</span>')\n                    .attr({\n                        'aria-label': requiredText,\n                        'title': requiredText,\n                    })\n                    .appendTo(this._$editIcon);\n            }\n\n            if (this.options.multiline && this.$el[0].id) {\n                $(`label[for=\"${this.$el[0].id}\"]`)\n                    .append(this._$editIcon);\n            } else {\n                this._$editIcon.insertAfter(this.$el);\n            }\n        }\n\n        if (!this.options.deferEventSetup) {\n            this.setupEvents();\n        }\n\n        if (this.options.startOpen) {\n            this.startEdit({\n                preventAnimation: true,\n            });\n        }\n\n        if (this.options.enabled) {\n            this.enable();\n        } else {\n            this.disable();\n        }\n\n        return this;\n    },\n\n    /**\n     * Create and return the field to use for the input element.\n     *\n     * Returns:\n     *     jQuery:\n     *     The newly created input element.\n     */\n    createField() {\n        if (this.options.multiline) {\n            return $('<textarea>').autoSizeTextArea();\n        } else {\n            return $('<input type=\"text\">');\n        }\n    },\n\n    /**\n     * Connect events.\n     */\n    setupEvents() {\n        this.$field\n            .keydown(e => {\n                e.stopPropagation();\n\n                switch (e.keyCode || e.charCode || e.which) {\n                    case 13: // Enter\n                        if (!this.options.multiline || e.ctrlKey) {\n                            this.submit();\n                        }\n\n                        if (!this.options.multiline) {\n                            e.preventDefault();\n                        }\n\n                        break;\n\n                    case 27: // Escape\n                        this.cancel();\n                        break;\n\n                    case 83: // S\n                    case 115: // s\n                        if (e.ctrlKey) {\n                            this.submit();\n                            e.preventDefault();\n                        }\n                        break;\n\n                    default:\n                        break;\n                }\n            })\n            .keypress(e => e.stopPropagation())\n            .keyup(e => {\n                e.stopPropagation();\n                e.preventDefault();\n\n                this._scheduleUpdateDirtyState();\n            })\n            .on('cut paste', () => this._scheduleUpdateDirtyState());\n\n        if (!this.options.useEditIconOnly) {\n            /*\n             * Check if the mouse was dragging, so that the editor isn't opened\n             * when text is selected.\n             */\n            let isDragging = true;\n\n            this.$el\n                .on('click', 'a', e => e.stopPropagation())\n                .click(e => {\n                    e.stopPropagation();\n                    e.preventDefault();\n\n                    if (!isDragging) {\n                        this.startEdit();\n                    }\n\n                    isDragging = true;\n                })\n                .mousedown(() => {\n                    isDragging = false;\n                    this.$el.one('mousemove', () => {\n                        isDragging = true;\n                    });\n                })\n                .mouseup(() => {\n                    this.$el.unbind('mousemove');\n                });\n        }\n\n        $(window).resize(this._fitWidthToParent.bind(this));\n    },\n\n    /**\n     * Start editing.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options for the operation.\n     *\n     * Option Args:\n     *     preventAnimation (boolean, optional):\n     *         Whether to prevent the default animation.\n     */\n    startEdit(options={}) {\n        if (this._editing || !this.options.enabled) {\n            return;\n        }\n\n        let value;\n\n        if (this.options.hasRawValue) {\n            this._initialValue = this.options.rawValue;\n            value = this._initialValue;\n        } else {\n            this._initialValue = this.$el.text();\n            value = this.normalizeText(this._initialValue).htmlDecode();\n        }\n\n        this._editing = true;\n        this.options.setFieldValue(this, value);\n\n        this.trigger('beginEditPreShow');\n        this.showEditor(options);\n        this.trigger('beginEdit');\n    },\n\n    /**\n     * Show the editor.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options for the operation.\n     *\n     * Options Args:\n     *     preventAnimation (boolean, optional):\n     *         Whether to prevent the default animation.\n     */\n    showEditor(options={}) {\n        if (this.options.multiline && !options.preventAnimation) {\n            this._$editIcon.fadeOut(this.options.animationSpeedMS);\n        } else {\n            this._$editIcon.hide();\n        }\n\n        this.$el.hide();\n        this._$form.show();\n\n        if (this.options.multiline) {\n            const elHeight = this.$el.outerHeight();\n            const newHeight = elHeight + this.options.extraHeight;\n\n            this._fitWidthToParent();\n\n            if (this._isTextArea) {\n                if (this.options.matchHeight) {\n                    // TODO: Set autosize min height\n                    this.$field\n                        .autoSizeTextArea('setMinHeight', newHeight)\n                        .css('overflow', 'hidden');\n\n                    if (options.preventAnimation) {\n                        this.$field.height(newHeight);\n                    } else {\n                        this.$field\n                            .height(elHeight)\n                            .animate({ height: newHeight },\n                                     this.options.animationSpeedMS);\n                    }\n                } else {\n                    /*\n                     * If there's significant processing that happens between\n                     * the text and what's displayed in the element, it's\n                     * likely that the rendered size will be different from the\n                     * editor size. In that case, don't try to match sizes,\n                     * just ask the field to auto-size itself to the size of\n                     * the source text.\n                     */\n                    this.$field.autoSizeTextArea('autoSize', true, false,\n                                                  elHeight);\n                }\n            }\n        }\n\n        this.$buttons.show();\n\n        // Execute this after the animation, if we performed one.\n        this.$field.queue(() => {\n            if (this.options.multiline && this._isTextArea) {\n                this.$field.css('overflow', 'auto');\n            }\n\n            this._fitWidthToParent();\n\n            if (this.options.focusOnOpen) {\n                this.$field.focus();\n            }\n\n            if (!this.options.multiline &&\n                this.$field[0].tagName === 'INPUT') {\n                this.$field[0].select();\n            }\n\n            this.$field.dequeue();\n        });\n    },\n\n    /**\n     * Hide the inline editor.\n     */\n    hideEditor() {\n        this.$field.blur();\n        this.$buttons.hide();\n\n        if (this.options.multiline) {\n            this._$editIcon.fadeIn(this.options.animationSpeedMS);\n        } else {\n            this._$editIcon.show();\n        }\n\n        if (this.options.multiline &&\n            this.options.matchHeight &&\n            this._editing &&\n            this._isTextArea) {\n            this.$field\n                .css('overflow', 'hidden')\n                .animate({ height: this.$el.outerHeight() },\n                        this.options.animationSpeedMS);\n        }\n\n        this.$field.queue(() => {\n            this.$el.show();\n            this._$form.hide();\n            this.$field.dequeue();\n        });\n\n        this._editing = false;\n        this._updateDirtyState();\n    },\n\n    /**\n     * Save the value of the editor.\n     */\n    save() {\n        const value = this.getValue();\n        const initialValue = this._initialValue;\n        const dirty = this.isDirty();\n\n        if (dirty) {\n            this.$el.html(this.options.formatResult(value));\n            this._initialValue = this.$el.text();\n        }\n\n        if (dirty || this.options.notifyUnchangedCompletion) {\n            this.trigger('complete', value, initialValue);\n\n            if (this.options.hasRawValue) {\n                this.options.rawValue = value;\n            }\n        } else {\n            this.trigger('cancel', this._initialValue);\n        }\n    },\n\n    /**\n     * Submit the editor.\n     */\n    submit() {\n        // hideEditor() resets the _dirty flag, so we need to save() first.\n        this.save();\n        this.hideEditor();\n    },\n\n    /**\n     * Cancel the edit.\n     */\n    cancel() {\n        if (!this.isDirty() ||\n            !this.options.promptOnCancel ||\n            confirm(gettext('You have unsaved changes. Are you sure you want to discard them?'))) {\n            this.hideEditor();\n            this.trigger('cancel', this._initialValue);\n        }\n    },\n\n    /**\n     * Return the dirty state of the editor.\n     *\n     * Returns:\n     *     boolean:\n     *     Whether the editor is currently dirty.\n     */\n    isDirty() {\n        if (this._dirtyCalcTimeout !== null) {\n            clearTimeout(this._dirtyCalcTimeout);\n            this._updateDirtyState();\n        }\n\n        return this._dirty;\n    },\n\n    /**\n     * Return the value in the field.\n     *\n     * Returns:\n     *     *:\n     *     The current value of the field.\n     */\n    getValue() {\n        return this.options.getFieldValue(this);\n    },\n\n    /**\n     * Set the value in the field.\n     *\n     * Args:\n     *     value (*):\n     *     The new value for the field.\n     */\n    setValue(value) {\n        this.options.setFieldValue(this, value);\n        this._updateDirtyState();\n    },\n\n    /**\n     * Enable the editor.\n     */\n    enable() {\n        if (this._editing) {\n            this.showEditor();\n        }\n\n        this._$editIcon.show();\n        this.options.enabled = true;\n    },\n\n    /**\n     * Disable the editor.\n     */\n    disable() {\n        if (this._editing) {\n            this.hideEditor();\n        }\n\n        this._$editIcon.hide();\n        this.options.enabled = false;\n    },\n\n    /**\n     * Return whether the editor is currently in edit mode.\n     *\n     * Returns:\n     *     boolean:\n     *     true if the inline editor is open.\n     */\n    editing() {\n        return this._editing;\n    },\n\n    /**\n     * Normalize the given text.\n     *\n     * Args:\n     *     text (string):\n     *         The text to normalize.\n     *\n     * Returns:\n     *     string:\n     *     The text with ``<br>`` elements turned into newlines and (in the\n     *     case of multi-line data), whitespace collapsed.\n     */\n    normalizeText(text) {\n        if (this.options.stripTags) {\n            /*\n             * Turn <br> elements back into newlines before stripping out all\n             * other tags. Without this, we lose multi-line data when editing\n             * some legacy data.\n             */\n            text = text.replace(/<br>/g, '\\n');\n            text = text.stripTags().strip();\n        }\n\n        if (!this.options.multiline) {\n            text = text.replace(/\\s{2,}/g, ' ');\n        }\n\n        return text;\n    },\n\n    /**\n     * Schedule an update for the dirty state.\n     */\n    _scheduleUpdateDirtyState() {\n        if (this._dirtyCalcTimeout === null) {\n            this._dirtyCalcTimeout = setTimeout(\n                this._updateDirtyState.bind(this), 200);\n        }\n    },\n\n    /**\n     * Update the dirty state of the editor.\n     */\n    _updateDirtyState() {\n        const newDirtyState = (\n            this._editing &&\n            this.options.isFieldDirty(this, this._initialValue));\n\n        if (this._dirty !== newDirtyState) {\n            this._dirty = newDirtyState;\n            this.trigger('dirtyStateChanged', this._dirty);\n        }\n\n        this._dirtyCalcTimeout = null;\n    },\n\n    /**\n     * Fit the editor width to the parent element.\n     */\n    _fitWidthToParent() {\n        if (!this._editing) {\n            return;\n        }\n\n        if (this.options.multiline) {\n            this.$field.css({\n                '-webkit-box-sizing': 'border-box',\n                '-moz-box-sizing': 'border-box',\n                'box-sizing': 'border-box',\n                'width': '100%',\n            });\n            return;\n        }\n\n        const $formParent = this._$form.parent();\n        const parentTextAlign = $formParent.css('text-align');\n        const isLeftAligned = (parentTextAlign === 'left');\n\n        if (!isLeftAligned) {\n            $formParent.css('text-align', 'left');\n        }\n\n        const boxSizing = this.$field.css('box-sizing');\n        let extentTypes;\n\n        if (boxSizing === 'border-box') {\n            extentTypes = 'm';\n        } else if (boxSizing === 'padding-box') {\n            extentTypes = 'p';\n        } else {\n            extentTypes = 'bmp';\n        }\n\n        let buttonsWidth = 0;\n\n        if (this.$buttons.length !== 0) {\n            const buttonsDisplay = this.$buttons.css('display');\n\n            if (buttonsDisplay === 'inline' ||\n                buttonsDisplay === 'inline-block') {\n                /*\n                 * The buttons are set for the same line as the field, so\n                 * factor the width of the buttons container into the field\n                 * width calculation below.\n                 */\n                buttonsWidth = this.$buttons.outerWidth();\n            }\n        }\n\n        /*\n         * First make the field really small so it will fit without wrapping,\n         * then figure out the offset and use it to calculate the desired\n         * width.\n         */\n        this.$field\n            .width(0)\n            .outerWidth(\n                $formParent.innerWidth() -\n                (this._$form.offset().left - $formParent.offset().left) -\n                this.$field.getExtents(extentTypes, 'lr') -\n                buttonsWidth);\n\n        if (!isLeftAligned) {\n            $formParent.css('text-align', parentTextAlign);\n        }\n    },\n});\n\n\n/**\n * A view for inline editors which use the CodeMirror editor for Markdown.\n */\nRB.RichTextInlineEditorView = RB.InlineEditorView.extend({\n    /**\n     * Defaults for the view options.\n     */\n    defaultOptions: _.defaults({\n        matchHeight: false,\n        multiline: true,\n        setFieldValue: (editor, value) =>\n            editor.textEditor.setText(value || ''),\n        getFieldValue: editor => editor.textEditor.getText(),\n        isFieldDirty: (editor, initialValue) => {\n            initialValue = editor.normalizeText(initialValue);\n\n            return editor.textEditor.isDirty(initialValue);\n        },\n    }, RB.InlineEditorView.prototype.defaultOptions),\n\n    /**\n     * Create and return the field to use for the input element.\n     *\n     * Returns:\n     *     jQuery:\n     *     The newly created input element.\n     */\n    createField() {\n        let origRichText;\n\n        this.textEditor = new RB.TextEditorView(this.options.textEditorOptions);\n        this.textEditor.$el.on('resize', () => this.trigger('resize'));\n\n        this.$el.data('text-editor', this.textEditor);\n\n        this.once('beginEdit', () => {\n            const $span = $('<span class=\"enable-markdown\">');\n            const $checkbox = $('<input type=\"checkbox\">')\n                .attr('id', _.uniqueId('markdown_check'))\n                .change(() => _.defer(() => this._updateDirtyState()))\n                .appendTo($span);\n\n            this.textEditor.bindRichTextCheckbox($checkbox);\n\n            $('<label>')\n                .attr('for', $checkbox[0].id)\n                .text(gettext('Enable Markdown'))\n                .appendTo($span);\n\n            this.$buttons.append($span);\n\n            const $markdownRef = $('<a class=\"markdown-info\" target=\"_blank\">')\n                .attr('href', `${MANUAL_URL}users/markdown/`)\n                .text(gettext('Markdown Reference'))\n                .setVisible(this.textEditor.richText)\n                .appendTo(this.$buttons);\n\n            this.textEditor.bindRichTextVisibility($markdownRef);\n        });\n\n        this.listenTo(this, 'beginEdit', () => {\n            this.textEditor._showEditor();\n            origRichText = this.textEditor.richText;\n        });\n\n        this.listenTo(this, 'cancel', () => {\n            this.textEditor._hideEditor();\n            this.textEditor.setRichText(origRichText);\n        });\n\n        this.listenTo(this, 'complete', () => this.textEditor._hideEditor());\n\n        return this.textEditor.render().$el;\n    },\n});\n"]}
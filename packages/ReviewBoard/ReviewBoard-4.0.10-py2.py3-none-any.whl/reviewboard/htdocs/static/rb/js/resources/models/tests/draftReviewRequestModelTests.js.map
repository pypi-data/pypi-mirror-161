{"version":3,"sources":["draftReviewRequestModelTests.es6.js"],"names":[],"mappings":"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","file":"draftReviewRequestModelTests.js","sourcesContent":["suite('rb/resources/models/DraftReviewRequest', function() {\n    let draft;\n    let callbacks;\n\n    beforeEach(function() {\n        const reviewRequest = new RB.ReviewRequest({\n            id: 1,\n            links: {\n                draft: {\n                    href: '/api/review-requests/123/draft/',\n                },\n            },\n        });\n\n        draft = reviewRequest.draft;\n\n        callbacks = {\n            success: function() {},\n            error: function() {},\n        };\n\n        spyOn(callbacks, 'success');\n        spyOn(callbacks, 'error');\n\n        spyOn(reviewRequest, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n\n        spyOn(reviewRequest, 'ensureCreated').and.callFake(\n            (options, context) => options.success.call(context));\n\n        spyOn(draft, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n    });\n\n    it('url', function() {\n        expect(draft.url()).toBe('/api/review-requests/123/draft/');\n    });\n\n    it('publish', function() {\n        spyOn(RB, 'apiCall').and.callThrough();\n        spyOn($, 'ajax').and.callFake(request => {\n            expect(request.data.public).toBe(1);\n\n            request.success({\n                stat: 'ok',\n                draft: {\n                    id: 1,\n                    links: {},\n                },\n            });\n        });\n\n        /* Set some fields in order to pass validation. */\n        draft.set({\n            targetGroups: [{\n                name: 'mygroup',\n                url: '/groups/mygroup',\n            }],\n            summary: 'My summary',\n            description: 'My description',\n        });\n\n        draft.publish({\n            success: callbacks.success,\n            error: callbacks.error,\n        });\n\n        expect(callbacks.error).not.toHaveBeenCalled();\n        expect(callbacks.success).toHaveBeenCalled();\n        expect(RB.apiCall).toHaveBeenCalled();\n        expect($.ajax).toHaveBeenCalled();\n    });\n\n    it('parse', function() {\n        const data = draft.parse({\n            stat: 'ok',\n            draft: {\n                id: 1,\n                branch: 'branch',\n                bugs_closed: 'bugsClosed',\n                changedescription: 'changeDescription',\n                changedescription_text_type: 'markdown',\n                description: 'description',\n                'public': 'public',\n                description_text_type: 'markdown',\n                summary: 'summary',\n                target_groups: 'targetGroups',\n                target_people: 'targetPeople',\n                testing_done: 'testingDone',\n                testing_done_text_type: 'plain',\n                links: {\n                    submitter: 'submitter',\n                },\n            },\n        });\n\n        expect(data).not.toBe(undefined);\n        expect(data.id).toBe(1);\n        expect(data.branch).toBe('branch');\n        expect(data.bugsClosed).toBe('bugsClosed');\n        expect(data.changeDescription).toBe('changeDescription');\n        expect(data.changeDescriptionRichText).toBe(true);\n        expect(data.description).toBe('description');\n        expect(data.descriptionRichText).toBe(true);\n        expect(data.public).toBe('public');\n        expect(data.summary).toBe('summary');\n        expect(data.submitter).toBe('submitter');\n        expect(data.targetGroups).toBe('targetGroups');\n        expect(data.targetPeople).toBe('targetPeople');\n        expect(data.testingDone).toBe('testingDone');\n        expect(data.testingDoneRichText).toBe(false);\n    });\n});\n"]}
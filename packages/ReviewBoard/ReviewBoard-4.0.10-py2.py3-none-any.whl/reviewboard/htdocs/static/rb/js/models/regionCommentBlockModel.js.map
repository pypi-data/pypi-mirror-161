{"version":3,"sources":["regionCommentBlockModel.es6.js"],"names":[],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAAC,kBAAH,GAAwB,EAAE,CAAC,0BAAH,CAA8B,MAA9B,CAAqC;EACzD,QAAQ,EAAE,CAAC,CAAC,QAAF,CAAW;IACjB,CAAC,EAAE,IADc;IAEjB,CAAC,EAAE,IAFc;IAGjB,KAAK,EAAE,IAHU;IAIjB,MAAM,EAAE;EAJS,CAAX,EAKP,EAAE,CAAC,oBAAH,CAAwB,SAAxB,CAAkC,QAL3B,CAD+C;EAQzD,gBAAgB,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,OAAX,EAAoB,QAApB,CARuC;;EAUzD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,KAAK,CAAC,MAAD,EAAS;IACV,MAAM,CAAC,CAAP,GAAW,QAAQ,CAAC,MAAM,CAAC,CAAR,EAAW,EAAX,CAAR,IAA0B,SAArC;IACA,MAAM,CAAC,CAAP,GAAW,QAAQ,CAAC,MAAM,CAAC,CAAR,EAAW,EAAX,CAAR,IAA0B,SAArC;IACA,MAAM,CAAC,KAAP,GAAe,QAAQ,CAAC,MAAM,CAAC,KAAR,EAAe,EAAf,CAAR,IAA8B,SAA7C;IACA,MAAM,CAAC,MAAP,GAAgB,QAAQ,CAAC,MAAM,CAAC,MAAR,EAAgB,EAAhB,CAAR,IAA+B,SAA/C;IAEA,OAAO,MAAP;EACH,CA/BwD;;EAiCzD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,eAAe,GAAG;IACd,OAAO,CAAC,CAAC,OAAF,CAAU,KAAK,GAAL,CAAS,oBAAT,CAAV,CAAP;EACH,CA7CwD;;EA+CzD;AACJ;AACA;AACA;AACA;AACA;EACI,sBAAsB,GAAG;IACrB,MAAM,YAAY,GAAG,KAAK,GAAL,CAAS,cAAT,CAArB;IAEA,YAAY,CAAC,KAAb,CAAmB;MACf,KAAK,EAAE,MAAM;QACT,MAAM,SAAS,GAAG,YAAY,CAAC,GAAb,CAAiB,WAAjB,CAAlB;QAEA,SAAS,CAAC,CAAV,GAAc,KAAK,GAAL,CAAS,GAAT,CAAd;QACA,SAAS,CAAC,CAAV,GAAc,KAAK,GAAL,CAAS,GAAT,CAAd;QACA,SAAS,CAAC,KAAV,GAAkB,KAAK,GAAL,CAAS,OAAT,CAAlB;QACA,SAAS,CAAC,MAAV,GAAmB,KAAK,GAAL,CAAS,QAAT,CAAnB;QAEA,YAAY,CAAC,IAAb,CAAkB;UACd,KAAK,EAAE,CACH,cADG,EAEH,cAFG,EAGH,kBAHG,EAIH,mBAJG,CADO;UAOd,aAAa,EAAE;QAPD,CAAlB;MASH;IAlBc,CAAnB;EAoBH;;AA5EwD,CAArC,CAAxB","file":"regionCommentBlockModel.js","sourcesContent":["/**\n * Represents the comments on a region of an image or document.\n *\n * RegionCommentBlock deals with creating and representing comments\n * that exist in a specific region of some content.\n *\n * Model Attributes:\n *     x (number):\n *         The X position of the region being commented upon.\n *\n *     y (number):\n *         The Y position of the region being commented upon.\n *\n *     width (number):\n *         The width of the region being commented upon.\n *\n *     height (number):\n *         The height of the region being commented upon.\n *\n * See Also:\n *     :js:class:`RB.FileAttachmentCommentBlock`:\n *         For attributes defined on the base model.\n *\n *     :js:class:`RB.AbstractCommentBlock`:\n *         For attributes defined on all comment block models.\n */\nRB.RegionCommentBlock = RB.FileAttachmentCommentBlock.extend({\n    defaults: _.defaults({\n        x: null,\n        y: null,\n        width: null,\n        height: null,\n    }, RB.AbstractCommentBlock.prototype.defaults),\n\n    serializedFields: ['x', 'y', 'width', 'height'],\n\n    /**\n     * Parse the incoming attributes for the comment block.\n     *\n     * The fields are stored server-side as strings, so we need to convert\n     * them back to integers where appropriate.\n     *\n     * Args:\n     *     fields (object):\n     *         The serialized fields for the comment.\n     *\n     * Returns:\n     *     object:\n     *     The parsed data.\n     */\n    parse(fields) {\n        fields.x = parseInt(fields.x, 10) || undefined;\n        fields.y = parseInt(fields.y, 10) || undefined;\n        fields.width = parseInt(fields.width, 10) || undefined;\n        fields.height = parseInt(fields.height, 10) || undefined;\n\n        return fields;\n    },\n\n    /**\n     * Return whether the bounds of this region can be updated.\n     *\n     * If there are any existing published comments on this region, it\n     * cannot be updated.\n     *\n     * Returns:\n     *     boolean:\n     *     A value indicating whether new bounds can be set for this region.\n     */\n    canUpdateBounds() {\n        return _.isEmpty(this.get('serializedComments'));\n    },\n\n    /**\n     * Save the new bounds of the draft comment to the server.\n     *\n     * The new bounds will be stored in the comment's ``x``, ``y``,\n     * ``width``, and ``height`` keys in ``extra_data``.\n     */\n    saveDraftCommentBounds() {\n        const draftComment = this.get('draftComment');\n\n        draftComment.ready({\n            ready: () => {\n                const extraData = draftComment.get('extraData');\n\n                extraData.x = this.get('x');\n                extraData.y = this.get('y');\n                extraData.width = this.get('width');\n                extraData.height = this.get('height');\n\n                draftComment.save({\n                    attrs: [\n                        'extra_data.x',\n                        'extra_data.y',\n                        'extra_data.width',\n                        'extra_data.height',\n                    ],\n                    boundsUpdated: true,\n                });\n            }\n        });\n    },\n});\n"]}
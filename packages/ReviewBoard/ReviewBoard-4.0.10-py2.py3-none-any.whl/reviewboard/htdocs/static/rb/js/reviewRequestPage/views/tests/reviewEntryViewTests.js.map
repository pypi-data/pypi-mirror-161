{"version":3,"sources":["reviewEntryViewTests.es6.js"],"names":[],"mappings":"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","file":"reviewEntryViewTests.js","sourcesContent":["suite('rb/reviewRequestPage/views/ReviewEntryView', function() {\n    const template = dedent`\n        <div class=\"review review-request-page-entry\">\n         <div class=\"review-request-page-entry-contents\">\n          <div class=\"collapse-button\"></div>\n          <div class=\"banners\">\n           <input type=\"button\" value=\"Publish\" />\n           <input type=\"button\" value=\"Discard\" />\n          </div>\n          <div class=\"comment-section\" data-context-type=\"body_top\">\n           <a class=\"add_comment_link\"></a>\n           <ul class=\"reply-comments\">\n            <li class=\"draft\" data-comment-id=\"456\">\n             <pre class=\"reviewtext\"></pre>\n            </li>\n           </ul>\n          </div>\n          <div class=\"comment-section\" data-context-id=\"123\"\n               data-context-type=\"diff_comments\">\n           <a class=\"add_comment_link\"></a>\n           <ul class=\"reply-comments\"></ul>\n          </div>\n          <div class=\"comment-section\" data-context-type=\"body_bottom\">\n           <a class=\"add_comment_link\"></a>\n           <ul class=\"reply-comments\"></ul>\n          </div>\n         </div>\n        </div>\n    `;\n    let view;\n    let reviewView;\n    let reviewReply;\n\n    beforeEach(function() {\n        const reviewRequest = new RB.ReviewRequest();\n        const editor = new RB.ReviewRequestEditor({\n            reviewRequest: reviewRequest\n        });\n        const review = reviewRequest.createReview({\n            loaded: true,\n            links: {\n                replies: {\n                    href: '/api/review/123/replies/',\n                },\n            },\n        });\n        const model = new RB.ReviewRequestPage.ReviewEntry({\n            review: review,\n            reviewRequest: reviewRequest,\n            reviewRequestEditor: editor,\n        });\n        const $el = $(template).appendTo($testsScratch);\n\n        reviewReply = review.createReply();\n\n        view = new RB.ReviewRequestPage.ReviewEntryView({\n            el: $el,\n            model: model,\n        });\n\n        view.render();\n\n        reviewView = view._reviewView;\n\n        /* Don't allow the draft banner to show. */\n        spyOn(reviewView, '_showReplyDraftBanner');\n        spyOn(reviewView, 'trigger').and.callThrough();\n\n        reviewView._setupNewReply(reviewReply);\n    });\n\n    describe('Actions', function() {\n        it('Toggle collapse', function() {\n            const $box = view.$('.review-request-page-entry-contents');\n            const $collapseButton = view.$('.collapse-button');\n\n            $collapseButton.click();\n            expect($box.hasClass('collapsed')).toBe(true);\n            $collapseButton.click();\n            expect($box.hasClass('collapsed')).toBe(false);\n        });\n    });\n\n    describe('Draft banner', function() {\n        describe('Visibility', function() {\n            it('Shown on hasDraft', function() {\n                const editor = reviewView._replyEditorViews[1].model;\n\n                reviewView._showReplyDraftBanner.calls.reset();\n\n                expect(editor.get('hasDraft')).toBe(false);\n                expect(reviewView._showReplyDraftBanner).not.toHaveBeenCalled();\n\n                editor.set('hasDraft', true);\n                expect(reviewView._showReplyDraftBanner).toHaveBeenCalled();\n            });\n        });\n    });\n\n    describe('Methods', function() {\n        it('collapse', function() {\n            view.collapse();\n            expect(\n                view.$('.review-request-page-entry-contents')\n                    .hasClass('collapsed'))\n                .toBe(true);\n        });\n\n        it('expand', function() {\n            const $box = view.$('.review-request-page-entry-contents')\n                .addClass('collapsed');\n            view.expand();\n            expect($box.hasClass('collapsed')).toBe(false);\n        });\n\n        describe('getReviewReplyEditorView', function() {\n            it('With body_top', function() {\n                const editorView = view.getReviewReplyEditorView('body_top');\n\n                expect(editorView).not.toBe(undefined);\n                expect(editorView).toBe(reviewView._replyEditorViews[0]);\n            });\n\n            it('With body_bottom', function() {\n                const editorView = view.getReviewReplyEditorView('body_bottom');\n\n                expect(editorView).not.toBe(undefined);\n                expect(editorView).toBe(reviewView._replyEditorViews[2]);\n            });\n\n            it('With comments', function() {\n                const editorView = view.getReviewReplyEditorView('diff_comments',\n                                                                 123);\n\n                expect(editorView).not.toBe(undefined);\n                expect(editorView).toBe(reviewView._replyEditorViews[1]);\n            });\n        });\n    });\n});\n"]}
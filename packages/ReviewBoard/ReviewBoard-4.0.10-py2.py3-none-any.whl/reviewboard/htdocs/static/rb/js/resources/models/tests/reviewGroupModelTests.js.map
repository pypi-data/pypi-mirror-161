{"version":3,"sources":["reviewGroupModelTests.es6.js"],"names":[],"mappings":"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","file":"reviewGroupModelTests.js","sourcesContent":["suite('rb/resources/models/ReviewGroup', function() {\n    describe('setStarred', function() {\n        const url = '/api/users/testuser/watched/groups/';\n        let callbacks;\n        let group;\n        let session;\n\n        beforeEach(function() {\n            RB.UserSession.instance = null;\n            session = RB.UserSession.create({\n                username: 'testuser',\n                watchedReviewGroupsURL: url,\n            });\n\n            group = new RB.ReviewGroup({\n                id: 1,\n            });\n\n            callbacks = {\n                success: function() {},\n                error: function() {},\n            };\n\n            spyOn(session.watchedGroups, 'addImmediately').and.callThrough();\n            spyOn(session.watchedGroups, 'removeImmediately').and.callThrough();\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn(callbacks, 'success');\n            spyOn(callbacks, 'error');\n        });\n\n        it('true', function() {\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('POST');\n                expect(request.url).toBe(url);\n\n                request.success({\n                    stat: 'ok',\n                });\n            });\n\n            group.setStarred(true, callbacks);\n\n            expect(session.watchedGroups.addImmediately).toHaveBeenCalled();\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n            expect(callbacks.error).not.toHaveBeenCalled();\n        });\n\n        it('false', function() {\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('DELETE');\n                expect(request.url).toBe(url + '1/');\n\n                request.success({\n                    stat: 'ok',\n                });\n            });\n\n            group.setStarred(false, callbacks);\n\n            expect(session.watchedGroups.removeImmediately).toHaveBeenCalled();\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n            expect(callbacks.error).not.toHaveBeenCalled();\n        });\n    });\n\n    describe('addUser', function() {\n        let callbacks;\n        let group;\n\n        beforeEach(function() {\n            group = new RB.ReviewGroup({\n                id: 1,\n                name: 'test-group',\n            });\n\n            callbacks = {\n                success: function() {},\n                error: function() {},\n            };\n\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn(callbacks, 'success');\n            spyOn(callbacks, 'error');\n        });\n\n        it('Loaded group', function() {\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('POST');\n                expect(request.data.username).toBe('my-user');\n\n                request.success({\n                    stat: 'ok',\n                });\n            });\n\n            group.addUser('my-user', callbacks);\n\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n        });\n\n        it('Unloaded group', function() {\n            spyOn($, 'ajax');\n\n            group.set('id', null);\n            expect(group.isNew()).toBe(true);\n\n            group.addUser('my-user', callbacks);\n\n            expect(RB.apiCall).not.toHaveBeenCalled();\n            expect($.ajax).not.toHaveBeenCalled();\n            expect(callbacks.error).toHaveBeenCalled();\n        });\n    });\n\n    describe('removeUser', function() {\n        let callbacks;\n        let group;\n\n        beforeEach(function() {\n            group = new RB.ReviewGroup({\n                id: 1,\n                name: 'test-group',\n            });\n\n            callbacks = {\n                success: function() {},\n                error: function() {},\n            };\n\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn(callbacks, 'success');\n            spyOn(callbacks, 'error');\n        });\n\n        it('Loaded group', function() {\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.type).toBe('DELETE');\n\n                request.success();\n            });\n\n            group.removeUser('my-user', callbacks);\n\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n            expect(callbacks.success).toHaveBeenCalled();\n        });\n\n        it('Unloaded group', function() {\n            spyOn($, 'ajax');\n\n            group.set('id', null);\n            expect(group.isNew()).toBe(true);\n\n            group.removeUser('my-user', callbacks);\n\n            expect(RB.apiCall).not.toHaveBeenCalled();\n            expect($.ajax).not.toHaveBeenCalled();\n            expect(callbacks.error).toHaveBeenCalled();\n        });\n    });\n});\n"]}
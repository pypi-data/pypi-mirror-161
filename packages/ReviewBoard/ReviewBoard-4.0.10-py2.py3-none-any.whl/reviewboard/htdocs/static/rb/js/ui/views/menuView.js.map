{"version":3,"sources":["menuView.es6.js"],"names":[],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAAC,QAAH,GAAc,QAAQ,CAAC,IAAT,CAAc,MAAd,CAAqB;EAC/B,SAAS,EAAE,WADoB;EAG/B,MAAM,EAAE;IACJ,WAAW;EADP,CAHuB;;EAO/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,UAAU,GAAa;IAAA,IAAZ,OAAY,uEAAJ,EAAI;;IACnB,IAAI,OAAO,CAAC,IAAR,KAAiB,SAAjB,IACA,OAAO,CAAC,IAAR,KAAiB,EAAE,CAAC,QAAH,CAAY,kBADjC,EACqD;MACjD,KAAK,IAAL,GAAY,EAAE,CAAC,QAAH,CAAY,kBAAxB;IACH,CAHD,MAGO,IAAI,OAAO,CAAC,IAAR,KAAiB,EAAE,CAAC,QAAH,CAAY,gBAAjC,EAAmD;MACtD,KAAK,IAAL,GAAY,EAAE,CAAC,QAAH,CAAY,gBAAxB;IACH,CAFM,MAEA;MACH,OAAO,CAAC,KAAR,CAAc,+CACA,2CADd,EAEc,OAAO,CAAC,IAFtB;MAGA,KAAK,IAAL,GAAY,EAAE,CAAC,QAAH,CAAY,kBAAxB;IACH;;IAED,IAAI,CAAC,KAAK,EAAV,EAAc;MACV,KAAK,EAAL,GAAU,CAAC,CAAC,QAAF,CAAW,WAAX,CAAV;IACH;;IAED,KAAK,WAAL,GAAmB,OAAO,CAAC,WAA3B;IACA,KAAK,MAAL,GAAc,KAAd;IAEA,KAAK,eAAL,GAAuB,OAAO,CAAC,cAA/B;IACA,KAAK,UAAL,GAAkB,OAAO,CAAC,SAA1B;IACA,KAAK,gBAAL,GAAwB,IAAxB;IACA,KAAK,aAAL,GAAqB,IAArB;EACH,CA1D8B;;EA4D/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,MAAM,GAAG;IACL,KAAK,GAAL,CACK,IADL,CACU;MACF,EAAE,EAAE,KAAK,EADP;MAEF,QAAQ,EAAE;IAFR,CADV;;IAMA,IAAI,KAAK,IAAL,KAAc,EAAE,CAAC,QAAH,CAAY,gBAA9B,EAAgD;MAC5C,KAAK,GAAL,CAAS,QAAT,CAAkB,gCAAlB;IACH;IAED;;;IACA,KAAK,GAAL,CAAS,IAAT,CAAc,MAAd,EAAsB,MAAtB;;IAEA,IAAI,KAAK,eAAT,EAA0B;MACtB,KAAK,GAAL,CAAS,IAAT,CAAc,iBAAd,EAAiC,KAAK,eAAtC;IACH,CAFD,MAEO,IAAI,KAAK,UAAT,EAAqB;MACxB,KAAK,GAAL,CAAS,IAAT,CAAc,YAAd,EAA4B,KAAK,UAAjC;IACH;;IAED,IAAI,KAAK,WAAT,EAAsB;MAClB,KAAK,WAAL,CAAiB,IAAjB,CAAsB;QAClB,iBAAiB,KAAK,EADJ;QAElB,iBAAiB,OAFC;QAGlB,iBAAiB;MAHC,CAAtB;IAKH;;IAED,OAAO,IAAP;EACH,CAnG8B;;EAqG/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,OAAO,GAAa;IAAA,IAAZ,OAAY,uEAAJ,EAAI;IAChB,IAAI,GAAJ;;IAEA,IAAI,KAAK,IAAL,KAAc,EAAE,CAAC,QAAH,CAAY,gBAA9B,EAAgD;MAC5C,GAAG,GAAG,CAAC,CACH,4DADG,CAAP;IAGH,CAJD,MAIO,IAAI,KAAK,IAAL,KAAc,EAAE,CAAC,QAAH,CAAY,kBAA9B,EAAkD;MACrD,GAAG,GAAG,CAAC,CAAC,+BAAD,CAAP;IACH,CAFM,MAEA;MACH;MACA,OAAO,CAAC,MAAR,CAAe,KAAf,EAAsB,2CAAtB;IACH;;IAED,IAAI,OAAO,CAAC,IAAR,KAAiB,SAArB,EAAgC;MAC5B,GAAG,CAAC,IAAJ,CAAS,OAAO,CAAC,IAAjB;IACH;;IAED,IAAI,OAAO,CAAC,OAAR,KAAoB,SAAxB,EAAmC;MAC/B,GAAG,CAAC,EAAJ,CAAO,OAAP,EAAgB,OAAO,CAAC,OAAxB;IACH;;IAED,GAAG,CACE,IADL,CACU;MACF,IAAI,EAAE,UADJ;MAEF,QAAQ,EAAE;IAFR,CADV,EAKK,EALL,CAKQ,WALR,EAKqB,KAAK,oBAAL,CAA0B,IAA1B,CAA+B,IAA/B,CALrB,EAMK,QANL,CAMc,KAAK,EANnB;IAQA,OAAO,GAAP;EACH,CAhK8B;;EAkK/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,IAAI,CAAC,OAAD,EAAU;IACV,KAAK,UAAL,CAAgB,IAAhB,EAAsB,OAAtB;EACH,CAnL8B;;EAqL/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,KAAK,CAAC,OAAD,EAAU;IACX,KAAK,UAAL,CAAgB,KAAhB,EAAuB,OAAvB;EACH,CAtM8B;;EAwM/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,cAAc,GAAG;IACb,IAAI,KAAK,EAAL,CAAQ,QAAR,CAAiB,MAAjB,GAA0B,CAA9B,EAAiC;MAC7B,KAAK,UAAL,CAAgB,CAAhB;IACH;EACJ,CArN8B;;EAuN/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,aAAa,GAAG;IACZ,MAAM,WAAW,GAAG,KAAK,EAAL,CAAQ,QAAR,CAAiB,MAArC;;IAEA,IAAI,WAAW,GAAG,CAAlB,EAAqB;MACjB,KAAK,UAAL,CAAgB,WAAW,GAAG,CAA9B;IACH;EACJ,CAtO8B;;EAwO/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,UAAU,CAAC,MAAD,EAAqB;IAAA,IAAZ,OAAY,uEAAJ,EAAI;;IAC3B,IAAI,KAAK,MAAL,KAAgB,MAApB,EAA4B;MACxB;IACH;;IAED,KAAK,gBAAL,GAAwB,IAAxB;IACA,KAAK,aAAL,GAAqB,IAArB;;IAEA,IAAI,OAAO,CAAC,OAAR,KAAoB,KAAxB,EAA+B;MAC3B,KAAK,GAAL,CAAS,QAAT,CAAkB,iBAAlB;;MACA,CAAC,CAAC,KAAF,CAAQ,MAAM,KAAK,GAAL,CAAS,WAAT,CAAqB,iBAArB,CAAd;IACH;;IAED,KAAK,MAAL,GAAc,MAAd;IAEA,MAAM,aAAa,GAAI,OAAO,CAAC,aAAR,KAA0B,KAAjD;;IAEA,IAAI,aAAJ,EAAmB;MACf,KAAK,OAAL,CAAa,MAAM,GAAG,SAAH,GAAe,SAAlC;IACH;;IAED,IAAI,MAAJ,EAAY;MACR,KAAK,GAAL,CAAS,QAAT,CAAkB,UAAlB;IACH,CAFD,MAEO;MACH,KAAK,GAAL,CAAS,WAAT,CAAqB,UAArB;IACH;;IAED,IAAI,KAAK,WAAT,EAAsB;MAClB,KAAK,WAAL,CAAiB,IAAjB,CAAsB,eAAtB,EAAuC,MAAvC;IACH;;IAED,IAAI,aAAJ,EAAmB;MACf,KAAK,OAAL,CAAa,MAAM,GAAG,QAAH,GAAc,QAAjC;IACH;EACJ,CA7R8B;;EA+R/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;EACI,UAAU,CAAC,KAAD,EAAQ;IACd,KAAK,gBAAL,GAAwB,KAAxB;IACA,KAAK,aAAL,GAAqB,KAAK,EAAL,CAAQ,QAAR,CAAiB,KAAjB,CAArB;;IACA,KAAK,aAAL,CAAmB,KAAnB;EACH,CA3S8B;;EA6S/B;AACJ;AACA;AACA;AACA;AACA;EACI,kBAAkB,GAAG;IACjB,IAAI,KAAK,gBAAL,KAA0B,IAA9B,EAAoC;MAChC,KAAK,cAAL;IACH,CAFD,MAEO;MACH,IAAI,KAAK,GAAG,KAAK,gBAAL,GAAwB,CAApC;;MAEA,IAAI,KAAK,GAAG,CAAZ,EAAe;QACX,KAAK,GAAG,KAAK,EAAL,CAAQ,QAAR,CAAiB,MAAjB,GAA0B,CAAlC;MACH;;MAED,KAAK,UAAL,CAAgB,KAAhB;IACH;EACJ,CA/T8B;;EAiU/B;AACJ;AACA;AACA;AACA;AACA;EACI,cAAc,GAAG;IACb,IAAI,KAAK,gBAAL,KAA0B,IAA9B,EAAoC;MAChC,KAAK,cAAL;IACH,CAFD,MAEO;MACH,IAAI,KAAK,GAAG,KAAK,gBAAL,GAAwB,CAApC;;MAEA,IAAI,KAAK,IAAI,KAAK,EAAL,CAAQ,QAAR,CAAiB,MAA9B,EAAsC;QAClC,KAAK,GAAG,CAAR;MACH;;MAED,KAAK,UAAL,CAAgB,KAAhB;IACH;EACJ,CAnV8B;;EAqV/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,UAAU,CAAC,GAAD,EAAM;IACZ,QAAQ,GAAG,CAAC,KAAZ;MACI,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,KAAlB;QACI;QACA,CAAC,CAAC,KAAK,aAAN,CAAD,CAAsB,cAAtB,CAAqC,OAArC;QACA,OAAO,KAAP;;MAEJ,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,MAAlB;MACA,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,GAAlB;QACI;QACA,IAAI,KAAK,WAAT,EAAsB;UAClB,KAAK,WAAL,CAAiB,KAAjB;QACH;;QAED,KAAK,KAAL,CAAW;UACP,OAAO,EAAE;QADF,CAAX;QAGA,OAAO,KAAP;;MAEJ,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,EAAlB;QACI;QACA,KAAK,kBAAL;;QACA,OAAO,KAAP;;MAEJ,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,IAAlB;QACI;QACA,KAAK,cAAL;;QACA,OAAO,KAAP;;MAEJ,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,IAAlB;MACA,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,OAAlB;QACI;QACA,KAAK,cAAL;QACA,OAAO,KAAP;;MAEJ,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,GAAlB;MACA,KAAK,CAAC,CAAC,EAAF,CAAK,OAAL,CAAa,SAAlB;QACI;QACA,KAAK,aAAL;QACA,OAAO,KAAP;IAtCR;EAwCH,CA9Y8B;;EAgZ/B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,oBAAoB,CAAC,GAAD,EAAM;IACtB,MAAM,QAAQ,GAAG,GAAG,CAAC,aAArB;;IAEA,IAAI,QAAQ,KAAK,KAAK,aAAtB,EAAqC;MACjC;MACA;IACH;;IAED,MAAM,SAAS,GAAG,KAAK,EAAL,CAAQ,QAA1B;;IAEA,KAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,SAAS,CAAC,MAA9B,EAAsC,CAAC,EAAvC,EAA2C;MACvC,IAAI,SAAS,CAAC,CAAD,CAAT,KAAiB,QAArB,EAA+B;QAC3B,KAAK,UAAL,CAAgB,CAAhB;;QACA;MACH;IACJ;EACJ;;AAza8B,CAArB,EA0aX;EACC;EACA,kBAAkB,EAAE,CAFrB;;EAIC;EACA,gBAAgB,EAAE;AALnB,CA1aW,CAAd","file":"menuView.js","sourcesContent":["/**\n * A standard implementation of drop-down menus.\n *\n * This can be used to create and populate a standard drop-down menu or a\n * button menu (where each menu item is a button). It handles animating the\n * opening and closing of the menu, applying ARIA attributes for accessibility,\n * and handling keyboard-based navigation.\n *\n * Menus are (optionally) associated with a controller element, which is the\n * button or element responsible for opening and closing the menu. Like the\n * menu itself, the appropriate ARIA attributes will be set on the element to\n * help screen readers associate it with the menu.\n *\n * Version Added:\n *     4.0\n *\n * Attributes:\n *     $controller (jQuery):\n *         The jQuery-wrapped element that controls the display of this menu.\n *\n *     isOpen (boolean):\n *         The current menu open state.\n *\n *     type (number):\n *         The configured type of menu. This will be one of\n *         :js:attr:`RB.MenuView.TYPE_BUTTON_MENU` or\n *         :js:attr:`RB.MenuView.TYPE_STANDARD_MENU`.\n */\nRB.MenuView = Backbone.View.extend({\n    className: 'rb-c-menu',\n\n    events: {\n        'keydown': '_onKeyDown',\n    },\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     $controller (jQuery, optional):\n     *         The jQuery-wrapped element that's responsible for opening and\n     *         closing this menu.\n     *\n     *     ariaLabel (string, optional):\n     *         An explicit descriptive ARIA label to set on the menu, to aid\n     *         screen readers.\n     *\n     *     ariaLabelledBy (string, optional):\n     *         The ID of an element that contains an existing descriptive\n     *         ARIA label to use for the menu, to aid screen readers. If\n     *         provided, this takes precedence over ``ariaLabel``.\n     *\n     *     type (number, optional):\n     *         The type of menu. If provided, this must be one of\n     *         :js:attr:`RB.MenuView.TYPE_BUTTON_MENU` or\n     *         :js:attr:`RB.MenuView.TYPE_STANDARD_MENU`. If not provided,\n     *         this will be a standard menu.\n     */\n    initialize(options={}) {\n        if (options.type === undefined ||\n            options.type === RB.MenuView.TYPE_STANDARD_MENU) {\n            this.type = RB.MenuView.TYPE_STANDARD_MENU;\n        } else if (options.type === RB.MenuView.TYPE_BUTTON_MENU) {\n            this.type = RB.MenuView.TYPE_BUTTON_MENU;\n        } else {\n            console.error('The provided RB.MenuView type (%s) is not ' +\n                          'supported. Defaulting to a standard menu.',\n                          options.type);\n            this.type = RB.MenuView.TYPE_STANDARD_MENU;\n        }\n\n        if (!this.id) {\n            this.id = _.uniqueId('__rb-menu');\n        }\n\n        this.$controller = options.$controller;\n        this.isOpen = false;\n\n        this._ariaLabelledBy = options.ariaLabelledBy;\n        this._ariaLabel = options.ariaLabel;\n        this._activeItemIndex = null;\n        this._activeItemEl = null;\n    },\n\n    /**\n     * Render the menu.\n     *\n     * This will set up the elements for the menu and associate it with the\n     * controller.\n     *\n     * Returns:\n     *     RB.MenuView:\n     *     This menu, for chaining.\n     */\n    render() {\n        this.$el\n            .attr({\n                id: this.id,\n                tabindex: '-1',\n            });\n\n        if (this.type === RB.MenuView.TYPE_BUTTON_MENU) {\n            this.$el.addClass('rb-c-button-group -is-vertical');\n        }\n\n        /* Set ARIA attributes on these and on the controller. */\n        this.$el.attr('role', 'menu');\n\n        if (this._ariaLabelledBy) {\n            this.$el.attr('aria-labelledby', this._ariaLabelledBy);\n        } else if (this._ariaLabel) {\n            this.$el.attr('aria-label', this._ariaLabel);\n        }\n\n        if (this.$controller) {\n            this.$controller.attr({\n                'aria-controls': this.id,\n                'aria-expanded': 'false',\n                'aria-haspopup': 'true',\n            });\n        }\n\n        return this;\n    },\n\n    /**\n     * Add an item to the menu.\n     *\n     * This appends an item to the bottom of the menu. It can append an\n     * explicit element (if one was already created), or it can build a new\n     * item appropriate for the type of menu.\n     *\n     * In either case, this can assign a DOM element ID to the menu item,\n     * assign a click event handler, and will set ARIA roles.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options for the menu item.\n     *\n     * Option Args:\n     *     id (string, optional):\n     *         A DOM element ID to assign to the menu item.\n     *\n     *     onClick (function, optional):\n     *         A function to call when the menu item is clicked.\n     *\n     *     text (string, optional):\n     *         Explicit text to use for the menu item.\n     *\n     * Returns:\n     *     jQuery:\n     *     The jQuery-wrapped element for the menu item.\n     */\n    addItem(options={}) {\n        let $el;\n\n        if (this.type === RB.MenuView.TYPE_BUTTON_MENU) {\n            $el = $(\n                '<button class=\"rb-c-menu__item rb-c-button\" type=\"button\">'\n            );\n        } else if (this.type === RB.MenuView.TYPE_STANDARD_MENU) {\n            $el = $('<div class=\"rb-c-menu__item\">');\n        } else {\n            /* This shouldn't be able to be reached. */\n            console.assert(false, 'RB.MenuView type is not a supported type.');\n        }\n\n        if (options.text !== undefined) {\n            $el.text(options.text);\n        }\n\n        if (options.onClick !== undefined) {\n            $el.on('click', options.onClick);\n        }\n\n        $el\n            .attr({\n                role: 'menuitem',\n                tabindex: '-1',\n            })\n            .on('mousemove', this._onMenuItemMouseMove.bind(this))\n            .appendTo(this.el);\n\n        return $el;\n    },\n\n    /**\n     * Open the menu.\n     *\n     * This will show the menu on the screen. Before it's shown, an ``opening``\n     * event will be emitted. Once shown (and after the animation finishes),\n     * the ``opened`` event will be emitted.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options to use when opening the menu.\n     *\n     * Option Args:\n     *     animate (boolean, optional):\n     *         Whether to animate the menu. This defaults to ``true``.\n     */\n    open(options) {\n        this._setOpened(true, options);\n    },\n\n    /**\n     * Close the menu.\n     *\n     * This will hide the menu. Before it's hidden, a ``closing`` event will\n     * be emitted. Once hidden (and after the animation finishes), the\n     * ``closed`` event will be emitted.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options to use when closing the menu.\n     *\n     * Option Args:\n     *     animate (boolean, optional):\n     *         Whether to animate the menu. This defaults to ``true``.\n     */\n    close(options) {\n        this._setOpened(false, options);\n    },\n\n    /**\n     * Focus the first item in the menu.\n     *\n     * This should be used by callers when programmatically displaying the\n     * menu (such as a result of keyboard input), when showing the menu below\n     * the controller.\n     *\n     * Once focused, arrow keys can be used to navigate the menu.\n     */\n    focusFirstItem() {\n        if (this.el.children.length > 0) {\n            this._focusItem(0);\n        }\n    },\n\n    /**\n     * Focus the last item in the menu.\n     *\n     * This should be used by callers when programmatically displaying the\n     * menu (such as a result of keyboard input), when showing the menu above\n     * the controller.\n     *\n     * Once focused, arrow keys can be used to navigate the menu.\n     */\n    focusLastItem() {\n        const numChildren = this.el.children.length;\n\n        if (numChildren > 0) {\n            this._focusItem(numChildren - 1);\n        }\n    },\n\n    /**\n     * Set the menu's open/closed state.\n     *\n     * This takes care of emitting the opening/opened/closing/closed events,\n     * setting active item states, setting the classes or display states, and\n     * setting appropriate ARIA attributes on the controller.\n     *\n     * Args:\n     *     opened (boolean):\n     *         Whether the menu is set to opened.\n     *\n     *     options (object, optional):\n     *         The options to use when setting state.\n     *\n     * Option Args:\n     *     triggerEvents (boolean, optional):\n     *         Whether to trigger events from a state change. This defaults\n     *         to ``true``.\n     */\n    _setOpened(opened, options={}) {\n        if (this.isOpen === opened) {\n            return;\n        }\n\n        this._activeItemIndex = null;\n        this._activeItemEl = null;\n\n        if (options.animate === false) {\n            this.$el.addClass('js-no-animation');\n            _.defer(() => this.$el.removeClass('js-no-animation'));\n        }\n\n        this.isOpen = opened;\n\n        const triggerEvents = (options.triggerEvents !== false);\n\n        if (triggerEvents) {\n            this.trigger(opened ? 'opening' : 'closing');\n        }\n\n        if (opened) {\n            this.$el.addClass('-is-open');\n        } else {\n            this.$el.removeClass('-is-open');\n        }\n\n        if (this.$controller) {\n            this.$controller.attr('aria-expanded', opened);\n        }\n\n        if (triggerEvents) {\n            this.trigger(opened ? 'opened' : 'closed');\n        }\n    },\n\n    /**\n     * Focus an item at the specified index.\n     *\n     * Args:\n     *     index (number):\n     *         The index of the menu item to focus. This is expected to be\n     *         a valid index in the list of items.\n     */\n    _focusItem(index) {\n        this._activeItemIndex = index;\n        this._activeItemEl = this.el.children[index];\n        this._activeItemEl.focus();\n    },\n\n    /**\n     * Focus the previous item in the menu.\n     *\n     * This takes care of wrapping the focus around to the end of the menu,\n     * if focus was already on the first item.\n     */\n    _focusPreviousItem() {\n        if (this._activeItemIndex === null) {\n            this.focusFirstItem();\n        } else {\n            let index = this._activeItemIndex - 1;\n\n            if (index < 0) {\n                index = this.el.children.length - 1;\n            }\n\n            this._focusItem(index);\n        }\n    },\n\n    /**\n     * Focus the next item in the menu.\n     *\n     * This takes care of wrapping the focus around to the beginning of\n     * the menu, if focus was already on the last item.\n     */\n    _focusNextItem() {\n        if (this._activeItemIndex === null) {\n            this.focusFirstItem();\n        } else {\n            let index = this._activeItemIndex + 1;\n\n            if (index >= this.el.children.length) {\n                index = 0;\n            }\n\n            this._focusItem(index);\n        }\n    },\n\n    /**\n     * Handle a keydown event.\n     *\n     * When the menu or a menu item has focus, this will take care of\n     * handling keyboard-based navigation, allowing the menu to be closed,\n     * or the focused menu item to be changed or activated.\n     *\n     * Args:\n     *     evt (jQuery.Event):\n     *         The keydown event.\n     *\n     * Returns:\n     *     boolean:\n     *     ``True`` if the event was handled explicitly by the menu.\n     *     ``False`` if it should bubble up or invoke default behavior.\n     */\n    _onKeyDown(evt) {\n        switch (evt.which) {\n            case $.ui.keyCode.ENTER:\n                /* Activate any selected item. */\n                $(this._activeItemEl).triggerHandler('click');\n                return false;\n\n            case $.ui.keyCode.ESCAPE:\n            case $.ui.keyCode.TAB:\n                /* Close the menu and bring focus back to the controller. */\n                if (this.$controller) {\n                    this.$controller.focus();\n                }\n\n                this.close({\n                    animate: false,\n                });\n                return false;\n\n            case $.ui.keyCode.UP:\n                /* Move up an item. */\n                this._focusPreviousItem();\n                return false;\n\n            case $.ui.keyCode.DOWN:\n                /* Move down an item. */\n                this._focusNextItem();\n                return false;\n\n            case $.ui.keyCode.HOME:\n            case $.ui.keyCode.PAGE_UP:\n                /* Move to the first item. */\n                this.focusFirstItem();\n                return false;\n\n            case $.ui.keyCode.END:\n            case $.ui.keyCode.PAGE_DOWN:\n                /* Move to the last item. */\n                this.focusLastItem();\n                return false;\n        }\n    },\n\n    /**\n     * Handle mousemove events on a menu item.\n     *\n     * This will move the focus to the menu item.\n     *\n     * Args:\n     *     evt (jQuery.Event):\n     *         The mousemove event.\n     */\n    _onMenuItemMouseMove(evt) {\n        const targetEl = evt.currentTarget;\n\n        if (targetEl === this._activeItemEl) {\n            /* The mouse has moved but the item hasn't changed. */\n            return;\n        }\n\n        const menuItems = this.el.children;\n\n        for (let i = 0; i < menuItems.length; i++) {\n            if (menuItems[i] === targetEl) {\n                this._focusItem(i);\n                break;\n            }\n        }\n    },\n}, {\n    /** Standard drop-down menus. */\n    TYPE_STANDARD_MENU: 1,\n\n    /** Button-based menus. */\n    TYPE_BUTTON_MENU: 2,\n});\n"]}